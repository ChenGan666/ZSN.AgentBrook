(function(){"use strict";var e={9566:function(e,t,o){var l=o(5130),n=(o(4603),o(7566),o(8721),o(6768)),a=o(4232);function s(e,t,o,l,s,i){const d=(0,n.g2)("Background"),u=(0,n.g2)("WorkFlowData"),c=(0,n.g2)("MiniMap"),r=(0,n.g2)("ToolIcon"),p=(0,n.g2)("ControlButton"),k=(0,n.g2)("Controls"),h=(0,n.g2)("ToolBox"),L=(0,n.g2)("Panel"),g=(0,n.g2)("CustomEdge"),v=(0,n.g2)("StartNode"),F=(0,n.g2)("EndNode"),m=(0,n.g2)("LargeModelNode"),b=(0,n.g2)("KnowledgeBaseNode"),C=(0,n.g2)("PluginsNode"),f=(0,n.g2)("SelectorNode"),w=(0,n.g2)("VueFlow");return(0,n.uX)(),(0,n.Wv)(w,{ref:"vueFlow",nodes:s.nodes,edges:s.edges,class:(0,a.C4)([{dark:s.dark},"basic-flow"]),"default-viewport":{zoom:1.5},"min-zoom":.2,"max-zoom":4,"apply-default":!1,"fit-view-on-init":"",onNodesChange:e.onNodesChange,onEdgesChange:e.onEdgesChange,onEdgeClick:i.edgeClick,onNodeClick:i.nodeClick,"connection-line-style":s.connectionLineStyle},{"edge-custom":(0,n.k6)((e=>[(0,n.bF)(g,{id:e.id,"source-x":e.sourceX,"source-y":e.sourceY,"target-x":e.targetX,"target-y":e.targetY,"source-position":e.sourcePosition,"target-position":e.targetPosition,data:e.data,"marker-end":e.markerEnd,style:(0,a.Tr)(e.style)},null,8,["id","source-x","source-y","target-x","target-y","source-position","target-position","data","marker-end","style"])])),"node-Start":(0,n.k6)((e=>[(0,n.bF)(v,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-End":(0,n.k6)((e=>[(0,n.bF)(F,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-LargeModel":(0,n.k6)((e=>[(0,n.bF)(m,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","largeModel","onSaveNode"])])),"node-KnowledgeBase":(0,n.k6)((e=>[(0,n.bF)(b,{id:e.id,data:e.data,isSelected:e.selected,knowledgeBase:s.knowledgeBaseList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","knowledgeBase","onSaveNode"])])),"node-Plugins":(0,n.k6)((e=>[(0,n.bF)(C,{id:e.id,data:e.data,isSelected:e.selected,plugins:s.pluginsList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","plugins","onSaveNode"])])),"node-Selector":(0,n.k6)((e=>[(0,n.bF)(f,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),default:(0,n.k6)((()=>[(0,n.bF)(d,{"pattern-color":"#f0f0f0",gap:15}),(0,n.bF)(u,{class:"vue-flow__panel top left"}),(0,n.bF)(c,{position:"bottom-left",class:"MiniMap"}),(0,n.bF)(k,{position:"bottom-left"},{default:(0,n.k6)((()=>[(0,n.bF)(p,{title:"Reset Transform",onClick:i.resetTransform},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:"reset"})])),_:1},8,["onClick"]),(0,n.bF)(p,{title:"Toggle Dark Mode",onClick:i.toggleDarkMode},{default:(0,n.k6)((()=>[s.dark?((0,n.uX)(),(0,n.Wv)(r,{key:0,name:"sun"})):((0,n.uX)(),(0,n.Wv)(r,{key:1,name:"moon"}))])),_:1},8,["onClick"]),(0,n.bF)(p,{title:"Log `toObject`",onClick:i.logToObject},{default:(0,n.k6)((()=>[(0,n.bF)(r,{name:"log"})])),_:1},8,["onClick"])])),_:1}),(0,n.bF)(L,{class:"ToolBox vue-flow__panel top left vue-flow__controls"},{default:(0,n.k6)((()=>[(0,n.bF)(h,{"is-visible":s.ShowNodeBox,"workflow-i-d":e.WorkFlowID,title:o.workflow_data.title,onAddNode:i.addNode},null,8,["is-visible","workflow-i-d","title","onAddNode"]),(0,n.bF)(p,{onClick:i.onShowNodeBox},{default:(0,n.k6)((()=>[s.ShowNodeBox?((0,n.uX)(),(0,n.Wv)(r,{key:1,name:"zoomout"})):((0,n.uX)(),(0,n.Wv)(r,{key:0,name:"zoomin"}))])),_:1},8,["onClick"])])),_:1})])),_:1},8,["nodes","edges","class","onNodesChange","onEdgesChange","onEdgeClick","onNodeClick","connection-line-style"])}o(4114);var i=o(144),d=o(6805),u=o(2647),c=o(4671),r=o(4039),p=o(4373);const k=p.A.create({baseURL:"/",headers:{"Content-Type":"application/json"}});class h{static get(e){return k.get(e).then((e=>e.data))}static post(e,t,o){return k.post(e,t,o).then((e=>e.data))}static put(e,t){return k.put(e,t).then((e=>e.data))}static delete(e){return k.delete(e).then((()=>!0))}static getBaseConfig(){return this.get("/Manage/Workflow/getBaseConfig")}static getWorkFlow(e,t,o){return this.post("/Manage/Workflow/getWorkFlow",{WorkflowID:e,MainID:t,MainType:o},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static addNode(e,t){return this.post("/Manage/Workflow/addNode",{WorkflowID:t,NodeType:e},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static subWorkFlow(e){return this.post("/Manage/Workflow/Save",e,{headers:{"Content-Type":"application/json"}})}static getNodeExcutionRecord(e,t){return this.post("getNodeExcutionRecord",{workflowID:e,nodeID:t})}static getChatLog(e){return this.post("getChatLog",{ChatSessionID:e})}}var L=h,g=o(1114);class v{}(0,g.A)(v,"guid",(function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)}))}));var F=v;const m={key:0,width:"16",height:"16",viewBox:"0 0 32 32"},b=(0,n.Lk)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),C=[b],f={key:1,width:"16",height:"16",viewBox:"0 0 32 5"},w=(0,n.Lk)("path",{d:"M0 0h32v4.2H0z"},null,-1),y=[w],_={key:2,width:"16",height:"16",viewBox:"0 0 32 32"},N=(0,n.Lk)("path",{d:"M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6l6-6l-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"},null,-1),I=[N],x={key:3,width:"16",height:"16",viewBox:"0 0 24 24"},E=(0,n.Lk)("path",{d:"M14 20v-2h2.6l-3.2-3.2l1.425-1.425L18 16.55V14h2v6Zm-8.6 0L4 18.6L16.6 6H14V4h6v6h-2V7.4Zm3.775-9.425L4 5.4L5.4 4l5.175 5.175Z"},null,-1),D=[E],S={key:4,width:"16",height:"16",viewBox:"0 0 24 24"},X=(0,n.Lk)("path",{d:"M12 17q-2.075 0-3.537-1.463Q7 14.075 7 12t1.463-3.538Q9.925 7 12 7t3.538 1.462Q17 9.925 17 12q0 2.075-1.462 3.537Q14.075 17 12 17ZM2 13q-.425 0-.712-.288Q1 12.425 1 12t.288-.713Q1.575 11 2 11h2q.425 0 .713.287Q5 11.575 5 12t-.287.712Q4.425 13 4 13Zm18 0q-.425 0-.712-.288Q19 12.425 19 12t.288-.713Q19.575 11 20 11h2q.425 0 .712.287q.288.288.288.713t-.288.712Q22.425 13 22 13Zm-8-8q-.425 0-.712-.288Q11 4.425 11 4V2q0-.425.288-.713Q11.575 1 12 1t.713.287Q13 1.575 13 2v2q0 .425-.287.712Q12.425 5 12 5Zm0 18q-.425 0-.712-.288Q11 22.425 11 22v-2q0-.425.288-.712Q11.575 19 12 19t.713.288Q13 19.575 13 20v2q0 .425-.287.712Q12.425 23 12 23ZM5.65 7.05L4.575 6q-.3-.275-.288-.7q.013-.425.288-.725q.3-.3.725-.3t.7.3L7.05 5.65q.275.3.275.7q0 .4-.275.7q-.275.3-.687.287q-.413-.012-.713-.287ZM18 19.425l-1.05-1.075q-.275-.3-.275-.712q0-.413.275-.688q.275-.3.688-.287q.412.012.712.287L19.425 18q.3.275.288.7q-.013.425-.288.725q-.3.3-.725.3t-.7-.3ZM16.95 7.05q-.3-.275-.287-.688q.012-.412.287-.712L18 4.575q.275-.3.7-.288q.425.013.725.288q.3.3.3.725t-.3.7L18.35 7.05q-.3.275-.7.275q-.4 0-.7-.275ZM4.575 19.425q-.3-.3-.3-.725t.3-.7l1.075-1.05q.3-.275.713-.275q.412 0 .687.275q.3.275.288.688q-.013.412-.288.712L6 19.425q-.275.3-.7.287q-.425-.012-.725-.287Z"},null,-1),j=[X],T={key:5,width:"16",height:"16",viewBox:"0 0 24 24"},M=(0,n.Lk)("path",{d:"M12 21q-3.75 0-6.375-2.625T3 12q0-3.75 2.625-6.375T12 3q.35 0 .688.025q.337.025.662.075q-1.025.725-1.637 1.887Q11.1 6.15 11.1 7.5q0 2.25 1.575 3.825Q14.25 12.9 16.5 12.9q1.375 0 2.525-.613q1.15-.612 1.875-1.637q.05.325.075.662Q21 11.65 21 12q0 3.75-2.625 6.375T12 21Z"},null,-1),B=[M],V={key:6,width:"16",height:"16",viewBox:"0 0 24 24"},q=(0,n.Lk)("path",{d:"M20 19V7H4v12h16m0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16m-7 14v-2h5v2h-5m-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59l3.99-4Z"},null,-1),O=[q];var U={__name:"ToolIcon",props:{name:{type:String,required:!0}},setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,["zoomin"===e.name?((0,n.uX)(),(0,n.CE)("svg",m,C)):(0,n.Q3)("",!0),"zoomout"===e.name?((0,n.uX)(),(0,n.CE)("svg",f,y)):(0,n.Q3)("",!0),"reset"===e.name?((0,n.uX)(),(0,n.CE)("svg",_,I)):(0,n.Q3)("",!0),"update"===e.name?((0,n.uX)(),(0,n.CE)("svg",x,D)):(0,n.Q3)("",!0),"sun"===e.name?((0,n.uX)(),(0,n.CE)("svg",S,j)):(0,n.Q3)("",!0),"moon"===e.name?((0,n.uX)(),(0,n.CE)("svg",T,B)):(0,n.Q3)("",!0),"log"===e.name?((0,n.uX)(),(0,n.CE)("svg",V,O)):(0,n.Q3)("",!0)],64))}};const Q=U;var K=Q;const W={class:"Title"},P={key:0,class:"NodeToolBox"},R=(0,n.Lk)("div",{class:"title"},"选择节点",-1),J={class:"items iconfont"},H=["onClick"],A={class:"Name"},Z=(0,n.Lk)("div",{class:"Icon RBt icon-jinrujiantouxiao"},null,-1);function $(e,t,o,l,s,i){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("div",W,(0,a.v_)(s.Title),1),o.isVisible?((0,n.uX)(),(0,n.CE)("div",P,[R,(0,n.Lk)("div",J,[(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.NodeList,((e,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t,onClick:t=>i.addNode(e.NodeType)},[(0,n.Lk)("div",{class:(0,a.C4)(["Icon",e.Icon])},null,2),(0,n.Lk)("div",A,(0,a.v_)(e.NodeName),1),Z],8,H)))),128))])])])):(0,n.Q3)("",!0)],64)}var z=o(8875),Y={name:"ToolBox",props:{node:Object,workflowID:String,isVisible:Boolean,title:String},data(){return{Title:this.title,NodeList:[{NodeName:"大模型",NodeType:"LargeModel",Icon:"icon-LargeModel",Description:"调用大语言模型，处理变量，配合提示词，生成输出"},{NodeName:"知识库",NodeType:"KnowledgeBase",Icon:"icon-KnowledgeBase",Description:"根据输入的文本，调用知识库，获取知识库数据"},{NodeName:"插件",NodeType:"Plugins",Icon:"icon-Plugins",Description:"插件可以提供更多能力，外部操作，获取外部数据等"},{NodeName:"选择器",NodeType:"Selector",Icon:"icon-selector1",Description:"可以通过选择器的定义，链接多个下游执行节点"}]}},methods:{addNode(e){L.addNode(e,this.workflowID).then((e=>{if(console.log(e),e.Status){var t=e.Data;this.$emit("addNode",t.Config)}else(0,z.me)({type:"warn",title:"Warn",text:e.ErrorDesc})}))}}},G=o(1241);const ee=(0,G.A)(Y,[["render",$]]);var te=ee;const oe={class:"WorkFlowData"},le={class:"title"};function ne(e,t,o,l,s,i){return(0,n.uX)(),(0,n.CE)("div",oe,[(0,n.Lk)("div",le,(0,a.v_)(o.title),1)])}var ae={name:"WorkFlowData",props:{title:String}};const se=(0,G.A)(ae,[["render",ne]]);var ie=se;const de={class:"Title"},ue=(0,n.Lk)("span",{class:"Icon ticon icon-LargeModel"},null,-1),ce=(0,n.Lk)("span",null,"大语言模型",-1),re={key:0,class:"Content"},pe=(0,n.Lk)("div",{class:"Description"},"调用大语言模型，处理变量，配合提示词，生成输出",-1),ke={class:"LargeModel Content"},he={class:"Title"},Le=(0,n.Lk)("span",null,"模型",-1),ge={key:0},ve=["value"],Fe={class:"Inputs Content"},me={class:"Title"},be=(0,n.Lk)("span",null,"输入",-1),Ce={key:0},fe=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),we=["onUpdate:modelValue"],ye=["onUpdate:modelValue"],_e={class:"Prompt Content"},Ne={class:"Title"},Ie=(0,n.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1),xe={key:0},Ee=["placeholder"],De={class:"Outputs Content"},Se={class:"Title"},Xe=(0,n.Lk)("span",null,"输出",-1),je={key:0},Te=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),Me=["onUpdate:modelValue"],Be=["onUpdate:modelValue"],Ve={name:"LargeModelNode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel}}};var qe=Object.assign(Ve,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox LargeModelNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",de,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),ue,ce,(0,n.bo)((0,n.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,n.uX)(),(0,n.CE)("div",re,[pe,(0,n.Lk)("div",ke,[(0,n.Lk)("div",he,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldLargeModel&&t.checkFoldLargeModel(...e))},null,2),Le]),t.isFold_largemodel?((0,n.uX)(),(0,n.CE)("div",ge,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.model.LargeModelID=e)},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.largeModelList,((e,t)=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:e.LargeModelID},(0,a.v_)(e.ModelOrganizationName)+"("+(0,a.v_)(e.Name)+")",9,ve)))),128))],512),[[l.u1,t.nodeData.model.LargeModelID]])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Fe,[(0,n.Lk)("div",me,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),be]),t.isFold_inputs?((0,n.uX)(),(0,n.CE)("div",Ce,[(0,n.Lk)("table",null,[fe,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,we),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,ye),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",_e,[(0,n.Lk)("div",Ne,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[6]||(o[6]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),Ie]),t.isFold_prompt?((0,n.uX)(),(0,n.CE)("div",xe,[(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":o[7]||(o[7]=e=>t.nodeData.prompt=e),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,8,Ee),[[l.Jo,t.nodeData.prompt]])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",De,[(0,n.Lk)("div",Se,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[8]||(o[8]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),Xe]),t.isFold_outputs?((0,n.uX)(),(0,n.CE)("div",je,[(0,n.Lk)("table",null,[Te,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.output,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Me),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Be),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const Oe=qe;var Ue=Oe;const Qe={class:"Title"},Ke=(0,n.Lk)("span",{class:"Icon ticon icon-Plugins"},null,-1),We=(0,n.Lk)("span",null,"插件",-1),Pe={key:0,class:"Content"},Re=(0,n.Lk)("div",{class:"Description"},"插件可以提供更多能力，外部操作，获取外部数据等",-1),Je={class:"Plugins Content"},He={class:"Title"},Ae=(0,n.Lk)("span",null,"插件",-1),Ze={key:0},$e=["value"],ze={class:"Inputs Content"},Ye={class:"Title"},Ge=(0,n.Lk)("span",null,"输入",-1),et={key:0},tt=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),ot=["onUpdate:modelValue"],lt=["onUpdate:modelValue"],nt={class:"Outputs Content"},at={class:"Title"},st=(0,n.Lk)("span",null,"输出",-1),it={key:0},dt=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),ut=["onUpdate:modelValue"],ct=["onUpdate:modelValue"],rt={name:"PluginsNode",props:{id:String,isSelected:Boolean,data:Object,plugins:Object},data(){return{label:this.data.label,nodeData:this.data,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_plugins:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins}}};var pt=Object.assign(rt,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox Plugins iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",Qe,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),Ke,We,(0,n.bo)((0,n.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,n.uX)(),(0,n.CE)("div",Pe,[Re,(0,n.Lk)("div",Je,[(0,n.Lk)("div",He,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldPlugins&&t.checkFoldPlugins(...e))},null,2),Ae]),t.isFold_plugins?((0,n.uX)(),(0,n.CE)("div",Ze,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.plugins.PluginsID=e)},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.pluginsList,((e,t)=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:e.PluginsID},(0,a.v_)(e.Name),9,$e)))),128))],512),[[l.u1,t.nodeData.plugins.PluginsID]])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",ze,[(0,n.Lk)("div",Ye,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Ge]),t.isFold_inputs?((0,n.uX)(),(0,n.CE)("div",et,[(0,n.Lk)("table",null,[tt,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,ot),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,lt),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",nt,[(0,n.Lk)("div",at,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[6]||(o[6]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),st]),t.isFold_outputs?((0,n.uX)(),(0,n.CE)("div",it,[(0,n.Lk)("table",null,[dt,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.output,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,ut),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,ct),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const kt=pt;var ht=kt;const Lt={class:"Title"},gt=(0,n.Lk)("span",{class:"Icon ticon icon-start"},null,-1),vt=(0,n.Lk)("span",null,"开始",-1),Ft={key:0,class:"Content"},mt=(0,n.Lk)("div",{class:"Description"},"工作流的起始节点，用于设定启动工作流需要的信息",-1),bt={class:"Inputs Content"},Ct={class:"Title"},ft=(0,n.Lk)("span",null,"输入",-1),wt={key:0},yt=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),_t=["onUpdate:modelValue"],Nt=["onUpdate:modelValue"],It={class:"Prompt Content"},xt={class:"Title"},Et=(0,n.Lk)("span",null,"提示词",-1),Dt={key:0},St=["placeholder"],Xt={name:"StartNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_prompt:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var jt=Object.assign(Xt,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox StartNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",Lt,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),gt,vt]),t.isFold?((0,n.uX)(),(0,n.CE)("div",Ft,[mt,(0,n.Lk)("div",bt,[(0,n.Lk)("div",Ct,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),ft]),t.isFold_inputs?((0,n.uX)(),(0,n.CE)("div",wt,[(0,n.Lk)("table",null,[yt,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,_t),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Nt),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",It,[(0,n.Lk)("div",xt,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[2]||(o[2]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),Et]),t.isFold_prompt?((0,n.uX)(),(0,n.CE)("div",Dt,[(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":o[3]||(o[3]=e=>t.nodeData.prompt=e),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,8,St),[[l.Jo,t.nodeData.prompt]])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const Tt=jt;var Mt=Tt;const Bt={class:"Title"},Vt=(0,n.Lk)("span",{class:"Icon ticon icon-end"},null,-1),qt=(0,n.Lk)("span",null,"结束",-1),Ot={key:0,class:"Content"},Ut=(0,n.Lk)("div",{class:"Description"},"工作流的结束节点，用于返回工作流运行后的结果信息",-1),Qt={class:"Outputs Content"},Kt={class:"Title"},Wt=(0,n.Lk)("span",null,"输出",-1),Pt={key:0},Rt=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),Jt=["onUpdate:modelValue"],Ht=["onUpdate:modelValue"],At={class:"Prompt Content"},Zt={class:"Title"},$t=(0,n.Lk)("span",null,"提示词（将输出变量与提示词整理，并让AI重新生成返回结果）",-1),zt={key:0},Yt=["placeholder"],Gt={name:"EndNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_outputs:!0,isFold_prompt:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var eo=Object.assign(Gt,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox EndNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",Bt,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),Vt,qt]),t.isFold?((0,n.uX)(),(0,n.CE)("div",Ot,[Ut,(0,n.Lk)("div",Qt,[(0,n.Lk)("div",Kt,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),Wt]),t.isFold_outputs?((0,n.uX)(),(0,n.CE)("div",Pt,[(0,n.Lk)("table",null,[Rt,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.output,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Jt),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Ht),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",At,[(0,n.Lk)("div",Zt,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[2]||(o[2]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),$t]),t.isFold_prompt?((0,n.uX)(),(0,n.CE)("div",zt,[(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":o[3]||(o[3]=e=>t.nodeData.prompt=e),placeholder:["请输入提示词："+t.nodeData.output.map((e=>"{{"+e.varname+"}}")).join(",")]},null,8,Yt),[[l.Jo,t.nodeData.prompt]])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const to=eo;var oo=to;const lo={class:"Title"},no=(0,n.Lk)("span",{class:"Icon ticon icon-selector1"},null,-1),ao=(0,n.Lk)("span",null,"选择器",-1),so={key:0,class:"Content"},io=(0,n.Lk)("div",{class:"Description"},"可以通过选择器的定义，链接多个下游执行节点",-1),uo={class:"Inputs Content"},co={class:"Title"},ro=(0,n.Lk)("span",null,"输入",-1),po={key:0},ko=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),ho=["onUpdate:modelValue"],Lo=["onUpdate:modelValue"],go={class:"Selector Content"},vo={class:"Title"},Fo=(0,n.Lk)("span",null,"条件判断",-1),mo={key:0},bo=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"判断条件"),(0,n.Lk)("th",null,"比较值"),(0,n.Lk)("th",null,"删除")],-1),Co=["onUpdate:modelValue"],fo=["value"],wo=["onUpdate:modelValue"],yo=["value"],_o=["onUpdate:modelValue"],No=["onClick"],Io=(0,n.Lk)("span",{class:"Icon ticon icon-add"},null,-1),xo=(0,n.Lk)("span",null,"增加条件",-1),Eo=[Io,xo],Do={name:"SelectorNode",props:{id:String,isSelected:Boolean,data:Object},created(){},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_selector:!0,selectorList:this.data.selector?this.data.selector.map(((e,t)=>(e.top=25*t+240,e.top_str="top:"+e.top+"px",e))):[],comparison:[{name:"等于",data:"=",text:"等于"},{name:"不等于",data:"!=",text:"不等于"},{name:"大于",data:">",text:"大于"},{name:"小于",data:"<",text:"小于"},{name:"包含",data:"~=",text:"包含"},{name:"不包含",data:"!~=",text:"不包含"}]}},methods:{resetHandleTop(){var e=185;this.isFold_inputs&&(e+=55),this.isFold_selector&&this.isFold?(this.isFold||this.isFold_inputs)&&(this.selectorList=this.selectorList.map(((t,o)=>(t.top=25*o+e,t.top_str="top:"+t.top+"px",t)))):this.selectorList=this.selectorList.map((e=>(e.top=0,e.top_str="",e)))},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label,selector:this.selectorList}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold,this.resetHandleTop()},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs,this.resetHandleTop()},checkFoldSelector(){this.isFold_selector=!this.isFold_selector,this.resetHandleTop()},onAdd(){var e=this.selectorList.length+1,t=25*this.selectorList.length+240;this.selectorList.push({id:"Handle_"+e,inputs:"2",comparison:"",value:"",top:t,top_str:"top:"+t+"px"}),this.saveNode()},onDel(e){this.selectorList=this.selectorList.filter((t=>t.id!==e.id)),this.saveNode()}}};var So=Object.assign(Do,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{id:"target_1",class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.selectorList,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id},[(0,n.bF)((0,i.R1)(d.h7),{id:e.id,class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:(0,a.Tr)(e.top_str)},null,8,["id","position","style"])])))),128)),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox SelectorNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",lo,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),no,ao,(0,n.bo)((0,n.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,n.uX)(),(0,n.CE)("div",so,[io,(0,n.Lk)("div",uo,[(0,n.Lk)("div",co,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),ro]),t.isFold_inputs?((0,n.uX)(),(0,n.CE)("div",po,[(0,n.Lk)("table",null,[ko,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,ho),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Lo),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",go,[(0,n.Lk)("div",vo,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_selector?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[4]||(o[4]=(...e)=>t.checkFoldSelector&&t.checkFoldSelector(...e))},null,2),Fo]),t.isFold_selector?((0,n.uX)(),(0,n.CE)("div",mo,[(0,n.Lk)("table",null,[bo,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.selectorList,(e=>((0,n.uX)(),(0,n.CE)("tr",{key:e.id},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t=>e.inputs=t},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:e.varname},(0,a.v_)(e.varname),9,fo)))),128))],8,Co),[[l.u1,e.inputs]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t=>e.comparison=t},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.comparison,(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.name,value:e.data},(0,a.v_)(e.text),9,yo)))),128))],8,wo),[[l.u1,e.comparison]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{placeholder:"留空代表字符串空","onUpdate:modelValue":t=>e.value=t},null,8,_o),[[l.Jo,e.value]])]),(0,n.Lk)("td",null,[(0,n.Lk)("span",{class:"Icon ticon icon-del del",onClick:o=>t.onDel(e)},null,8,No)])])))),128))]),(0,n.Lk)("footer",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("td",{colspan:"4",class:"add",onClick:o[5]||(o[5]=(...e)=>t.onAdd&&t.onAdd(...e))},Eo)])])])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const Xo=So;var jo=Xo,To=o(8074);const Mo={class:"Title"},Bo=(0,n.Lk)("span",{class:"Icon ticon icon-KnowledgeBase"},null,-1),Vo=(0,n.Lk)("span",null,"知识库",-1),qo={key:0,class:"Content"},Oo=(0,n.Lk)("div",{class:"Description"},"根据输入的文本，调用知识库，获取知识库数据",-1),Uo={class:"Inputs Content"},Qo={class:"Title"},Ko=(0,n.Lk)("span",null,"输入",-1),Wo={key:0},Po=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),Ro=["onUpdate:modelValue"],Jo=["onUpdate:modelValue"],Ho={class:"KnowledgeBase Content"},Ao={class:"Title"},Zo=(0,n.Lk)("span",null,"知识库",-1),$o={key:0},zo={class:"Outputs Content"},Yo={class:"Title"},Go=(0,n.Lk)("span",null,"输出",-1),el={key:0},tl=(0,n.Lk)("thead",null,[(0,n.Lk)("th",null,"变量名"),(0,n.Lk)("th",null,"描述")],-1),ol=["onUpdate:modelValue"],ll=["onUpdate:modelValue"],nl={name:"KnowledgeBaseNode",props:{id:String,isSelected:Boolean,data:Object,knowledgeBase:Object},components:{Multiselect:To.Ay},data(){return{label:this.data.label,nodeData:this.data,KnowledgeBaseList:this.knowledgeBase,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_KnowledgeBase:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldKnowledgeBase(){console.log(this.KnowledgeBaseList),this.isFold_KnowledgeBase=!this.isFold_KnowledgeBase}}};var al=Object.assign(nl,{setup(e){return(t,o)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,n.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,n.Lk)("div",{class:(0,a.C4)(["NodeBox KnowledgeBaseNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,n.Lk)("div",Mo,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),Bo,Vo,(0,n.bo)((0,n.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,n.uX)(),(0,n.CE)("div",qo,[Oo,(0,n.Lk)("div",Uo,[(0,n.Lk)("div",Qo,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Ko]),t.isFold_inputs?((0,n.uX)(),(0,n.CE)("div",Wo,[(0,n.Lk)("table",null,[Po,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.inputs,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Ro),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Jo),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",Ho,[(0,n.Lk)("div",Ao,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_KnowledgeBase?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[4]||(o[4]=(...e)=>t.checkFoldKnowledgeBase&&t.checkFoldKnowledgeBase(...e))},null,2),Zo]),t.isFold_KnowledgeBase?((0,n.uX)(),(0,n.CE)("div",$o,[(0,n.bF)((0,i.R1)(To.Ay),{modelValue:t.nodeData.knowledgeBase,"onUpdate:modelValue":o[5]||(o[5]=e=>t.nodeData.knowledgeBase=e),placeholder:"请选择知识库",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.KnowledgeBaseList},null,8,["modelValue","options"])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",zo,[(0,n.Lk)("div",Yo,[(0,n.Lk)("span",{class:(0,a.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[6]||(o[6]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),Go]),t.isFold_outputs?((0,n.uX)(),(0,n.CE)("div",el,[(0,n.Lk)("table",null,[tl,(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.nodeData.output,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,ol),[[l.Jo,e.varname]])]),(0,n.Lk)("td",null,[(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,ll),[[l.Jo,e.txt]])])])))),128))])])])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)],2)],64))}});const sl=al;var il=sl;const dl=["cx","cy"],ul=["d"],cl=["transform","d"],rl={inheritAttrs:!1};var pl=Object.assign(rl,{__name:"CustomEdge",props:{id:{type:String,required:!0},sourceX:{type:Number,required:!0},sourceY:{type:Number,required:!0},targetX:{type:Number,required:!0},targetY:{type:Number,required:!0},sourcePosition:{type:String,required:!0},targetPosition:{type:String,required:!0},data:{type:Object,required:!1},markerEnd:{type:String,required:!1},style:{type:Object,required:!1}},setup(e){const t=e,o=(0,n.EW)((()=>(0,d.Fp)(t)));return(l,s)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)((0,i.R1)(d.tE),{id:e.id,style:(0,a.Tr)(e.style),path:o.value[0],"marker-end":e.markerEnd,label:e.data.text,"label-x":o.value[1],"label-y":o.value[2],"label-style":{fill:"white"},"label-show-bg":!0,"label-bg-style":{fill:"red"},"label-bg-padding":[2,4],"label-bg-border-radius":2},null,8,["id","style","path","marker-end","label","label-x","label-y"]),(0,n.Lk)("g",null,[(0,n.Lk)("circle",{cx:t.sourceX,cy:t.sourceY,r:"4",fill:"#29a3ff"},null,8,dl),(0,n.Lk)("path",{d:o.value,fill:"none",stroke:"#29a3ff","stroke-width":"2"},null,8,ul),(0,n.Lk)("path",{transform:l.transform,d:`M ${e.targetX} ${e.targetY+2} L ${e.targetX-5} ${e.targetY-10} L ${e.targetX+5} ${e.targetY-10} Z`,fill:"#3e47de",stroke:"none"},null,8,cl)])],64))}});const kl=pl;var hl=kl,Ll=null,gl={name:"WorkFlow",props:{workflow_data:{title:"智能助理",WorkFlowID:"",MainID:"",MainType:2}},components:{VueFlow:d.nO,Background:u.V,MiniMap:r.of,ToolBox:te,Controls:c.H,ToolIcon:K,ControlButton:c.a,WorkFlowData:ie,LargeModelNode:Ue,PluginsNode:ht,StartNode:Mt,EndNode:oo,SelectorNode:jo,CustomEdge:hl,KnowledgeBaseNode:il},setup(){const{onInit:e,onNodeDragStop:t,onConnect:o,addEdges:l,setViewport:n,toObject:a,onNodesChange:s,applyNodeChanges:u,onEdgesChange:c,applyEdgeChanges:r}=(0,d.Id)();e((e=>{e.fitView()})),t((()=>{Ll.nodes=a().nodes})),o((e=>{e.id=F.guid(),e.markerEnd=d.TG.ArrowClosed,e.style="stroke-width: 3;stroke:#3e47de;",l(e),Ll.edges=a().edges})),s((e=>{const t=[];for(const l of e)if("remove"===l.type){var o=Ll.nodes.filter((e=>e.id===l.id));if(o.length>0){if("Start"===o[0].type){(0,z.me)({type:"warn",title:"开始节点不能删除"});continue}if("End"===o[0].type){(0,z.me)({type:"warn",title:"结束节点不能删除"});continue}t.push(l)}}else t.push(l);u(t)})),c((e=>{const t=[];for(const o of e)if("remove"===o.type){if(Ll.selectedNode)continue;t.push(o)}else t.push(o);r(t)}));const p=(0,i.KR)(n),k=(0,i.KR)(a);return{_setViewport:p,_toObject:k}},mounted(){let e=this;this.init(),Ll=e},unmount(){this.stopInterval()},data(){return{ShowNodeBox:!1,workflow:{title:this.workflow_data.title},pluginsList:[],largeModelList:[],knowledgeBaseList:[],nodes:[],edges:[],dark:(0,i.KR)(!1),selectedNode:null,selectEdge:null,connectionLineStyle:{stroke:"#ddd",strokeWidth:3},intervalId:null}},methods:{logToObject(){this.save(),console.log(Ll.nodes),console.log(Ll.edges)},resetTransform(){this._setViewport({x:0,y:0,zoom:1})},onShowNodeBox(){this.ShowNodeBox=!this.ShowNodeBox},toggleDarkMode(){this.dark=!this.dark},addNode(e){console.log(e),this.nodes.push(e)},saveNode(e){this.nodes=this.nodes.map((t=>(t.id==e.id&&(t.data=e.data),t)))},nodeClick(e){this.selectedNode=e,this.selectEdge=null},edgeClick(e){this.selectedNode=null,this.selectEdge=e},startInterval(){this.intervalId=setInterval(this.save,5e3)},stopInterval(){this.intervalId&&clearInterval(this.intervalId)},async init(){L.getBaseConfig().then((e=>{if(console.log(e),e.Status){var t=e.Data;this.largeModelList=(0,i.KR)(t.largeModelList),this.pluginsList=t.pluginsList,this.knowledgeBaseList=t.knowledgeBaseList}this.getWorkFlow()})).catch((e=>{console.log(e)}))},getWorkFlow(){var e=this;L.getWorkFlow(e.workflow_data.WorkFlowID,e.workflow_data.MainID,e.workflow_data.MainType).then((t=>{if(console.log(t),t.Status){var o=t.Data;e.workflow_data.title=o.Info.WorkflowName,o.Nodes.map((e=>{this.nodes.push(e.Config)})),o.Edges.map((e=>{this.edges.push(e.Config)}))}})).catch((e=>{console.log(e)}))},save(){var e=this,t=e.workflow_data.WorkFlowID,o={WorkFlowID:t,MainType:e.workflow_data.MainType,MainID:e.workflow_data.MainID,WorkflowName:"",Description:""},l=this._toObject().nodes.map((e=>({NodeID:e.id,WorkFlowID:t,NodeType:e.type,NodeName:e.data.label,Description:e.data.label,Config:e}))),n=this._toObject().edges.map((e=>({EdgeID:e.id,WorkFlowID:t,SourceNodeId:e.source,TargetNodeId:e.target,Condition:"",LName:"",Config:e}))),a={Info:o,Nodes:l,Edges:n,WorkFlowID:t,MainID:e.workflow_data.MainID,MainType:e.workflow_data.MainType};L.subWorkFlow(a).then((t=>{console.log(t),t.Status&&(e.workflow_data.WorkFlowID=t.Data)})).catch((e=>{console.log(e)}))}}};const vl=(0,G.A)(gl,[["render",s]]);var Fl=vl;const ml={name:"App",components:{WorkFlow:Fl},created(){this.parseUrlParams()},methods:{parseUrlParams(){const e=new URLSearchParams(window.location.search);this.workflow_data.WorkFlowID=e.get("WorkFlowID"),this.workflow_data.MainID=e.get("MainID"),this.workflow_data.MainType=e.get("MainType")}},data(){return{workflow_data:{title:"工作流",WorkFlowID:"",MainID:"",MainType:2}}}};var bl=Object.assign(ml,{setup(e){return(e,t)=>{const o=(0,n.g2)("notifications");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(Fl,{workflow_data:e.workflow_data},null,8,["workflow_data"]),(0,n.bF)(o)],64)}}});const Cl=bl;var fl=Cl;const wl=(0,l.Ef)(fl);wl.use(z.Ay),wl.mount("#app")}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var a=t[l]={exports:{}};return e[l].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,l,n,a){if(!l){var s=1/0;for(c=0;c<e.length;c++){l=e[c][0],n=e[c][1],a=e[c][2];for(var i=!0,d=0;d<l.length;d++)(!1&a||s>=a)&&Object.keys(o.O).every((function(e){return o.O[e](l[d])}))?l.splice(d--,1):(i=!1,a<s&&(s=a));if(i){e.splice(c--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[l,n,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,a,s=l[0],i=l[1],d=l[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(n in i)o.o(i,n)&&(o.m[n]=i[n]);if(d)var c=d(o)}for(t&&t(l);u<s.length;u++)a=s[u],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(c)},l=self["webpackChunkworkflow"]=self["webpackChunkworkflow"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[504],(function(){return o(9566)}));l=o.O(l)})();
//# sourceMappingURL=app.c72446a2.js.map