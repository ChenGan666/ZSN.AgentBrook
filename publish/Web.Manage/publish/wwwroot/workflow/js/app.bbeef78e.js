(function(){"use strict";var e={2436:function(e,t,o){var l=o(5130),a=(o(4603),o(7566),o(8721),o(6768)),n=o(4232);function s(e,t,o,l,s,d){const i=(0,a.g2)("Background"),u=(0,a.g2)("WorkFlowData"),c=(0,a.g2)("MiniMap"),p=(0,a.g2)("ToolIcon"),r=(0,a.g2)("ControlButton"),k=(0,a.g2)("Controls"),h=(0,a.g2)("WorkFlowInfo"),m=(0,a.g2)("Panel"),v=(0,a.g2)("ToolBox"),g=(0,a.g2)("CustomEdge"),L=(0,a.g2)("StartNode"),F=(0,a.g2)("EndNode"),b=(0,a.g2)("AgentStartNode"),f=(0,a.g2)("AgentEndNode"),C=(0,a.g2)("LargeModelNode"),D=(0,a.g2)("KnowledgeBaseNode"),y=(0,a.g2)("PluginsNode"),_=(0,a.g2)("SelectorNode"),I=(0,a.g2)("TimeTrigger"),N=(0,a.g2)("MainAINode"),w=(0,a.g2)("AgentNode"),V=(0,a.g2)("ReporterNode"),j=(0,a.g2)("VueFlow");return(0,a.uX)(),(0,a.Wv)(j,{ref:"vueFlow",nodes:s.nodes,edges:s.edges,class:(0,n.C4)([{dark:s.dark},"basic-flow"]),"default-viewport":{zoom:1.5},"min-zoom":.2,"max-zoom":4,"apply-default":!1,"fit-view-on-init":"",onNodesChange:e.onNodesChange,onEdgesChange:e.onEdgesChange,onEdgeClick:d.edgeClick,onNodeClick:d.nodeClick,"connection-line-style":s.connectionLineStyle},{"edge-custom":(0,a.k6)((e=>[(0,a.bF)(g,{id:e.id,"source-x":e.sourceX,"source-y":e.sourceY,"target-x":e.targetX,"target-y":e.targetY,"source-position":e.sourcePosition,"target-position":e.targetPosition,data:e.data,"marker-end":e.markerEnd,style:(0,n.Tr)(e.style)},null,8,["id","source-x","source-y","target-x","target-y","source-position","target-position","data","marker-end","style"])])),"node-Start":(0,a.k6)((e=>[(0,a.bF)(L,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-End":(0,a.k6)((e=>[(0,a.bF)(F,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-AgentStart":(0,a.k6)((e=>[(0,a.bF)(b,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-AgentEnd":(0,a.k6)((e=>[(0,a.bF)(f,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-LargeModel":(0,a.k6)((e=>[(0,a.bF)(C,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,plugins:s.pluginsList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","largeModel","plugins","onSaveNode"])])),"node-KnowledgeBase":(0,a.k6)((e=>[(0,a.bF)(D,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,knowledgeBase:s.knowledgeBaseList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","largeModel","knowledgeBase","onSaveNode"])])),"node-Plugins":(0,a.k6)((e=>[(0,a.bF)(y,{id:e.id,data:e.data,isSelected:e.selected,plugins:s.pluginsList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","plugins","onSaveNode"])])),"node-Selector":(0,a.k6)((e=>[(0,a.bF)(_,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-TimeTrigger":(0,a.k6)((e=>[(0,a.bF)(I,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:d.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-MainAI":(0,a.k6)((e=>[(0,a.bF)(N,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,plugins:s.pluginsList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","largeModel","plugins","onSaveNode"])])),"node-Agent":(0,a.k6)((e=>[(0,a.bF)(w,{id:e.id,data:e.data,isSelected:e.selected,agents:s.agentList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","agents","onSaveNode"])])),"node-Reporter":(0,a.k6)((e=>[(0,a.bF)(V,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,onSaveNode:d.saveNode},null,8,["id","data","isSelected","largeModel","onSaveNode"])])),default:(0,a.k6)((()=>[(0,a.bF)(i,{"pattern-color":"#f0f0f0",gap:15}),(0,a.bF)(u,{class:"vue-flow__panel top left"}),(0,a.bF)(c,{position:"bottom-left",class:"MiniMap"}),(0,a.bF)(k,{position:"bottom-left"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{title:"Reset Transform",onClick:d.resetTransform},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"reset"})])),_:1},8,["onClick"]),(0,a.bF)(r,{title:"Toggle Dark Mode",onClick:d.toggleDarkMode},{default:(0,a.k6)((()=>[s.dark?((0,a.uX)(),(0,a.Wv)(p,{key:0,name:"sun"})):((0,a.uX)(),(0,a.Wv)(p,{key:1,name:"moon"}))])),_:1},8,["onClick"]),(0,a.bF)(r,{title:"Log `toObject`",onClick:d.logToObject},{default:(0,a.k6)((()=>[(0,a.bF)(p,{name:"log"})])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(m,{class:"WorkFlowInfo vue-flow__panel top left vue-flow__controls"},{default:(0,a.k6)((()=>[(0,a.bF)(h,{info:s.info,"onUpdate:info":t[0]||(t[0]=e=>s.info=e),onSave:d.save},null,8,["info","onSave"])])),_:1}),(0,a.bF)(m,{class:"ToolBox vue-flow__panel top left vue-flow__controls"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{"is-visible":s.ShowNodeBox,"workflow-i-d":o.workflow_data.WorkFlowID,"main-i-d":o.workflow_data.MainID,nodeClass:o.workflow_data.MainType,onAddNode:d.addNode},null,8,["is-visible","workflow-i-d","main-i-d","nodeClass","onAddNode"]),(0,a.bF)(r,{onClick:d.onShowNodeBox},{default:(0,a.k6)((()=>[s.ShowNodeBox?((0,a.uX)(),(0,a.Wv)(p,{key:1,name:"zoomout"})):((0,a.uX)(),(0,a.Wv)(p,{key:0,name:"zoomin"}))])),_:1},8,["onClick"])])),_:1})])),_:1},8,["nodes","edges","class","onNodesChange","onEdgesChange","onEdgeClick","onNodeClick","connection-line-style"])}o(4114);var d=o(144),i=o(6805),u=o(2647),c=o(4671),p=o(4039),r=o(4373);const k=r.A.create({baseURL:"/",headers:{"Content-Type":"application/json"}});class h{static get(e){return k.get(e).then((e=>e.data))}static post(e,t,o){return k.post(e,t,o).then((e=>e.data))}static put(e,t){return k.put(e,t).then((e=>e.data))}static delete(e){return k.delete(e).then((()=>!0))}static getBaseConfig(){return this.get("/Manage/Workflow/getBaseConfig")}static getWorkFlow(e,t,o){return this.post("/Manage/Workflow/getWorkFlow",{WorkflowID:e,MainID:t,MainType:o},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static addNode(e,t,o){return this.post("/Manage/Workflow/addNode",{WorkflowID:t,NodeType:e,MainID:o},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static subWorkFlow(e){return this.post("/Manage/Workflow/Save",e,{headers:{"Content-Type":"application/json"}})}static getNodeExcutionRecord(e,t){return this.post("getNodeExcutionRecord",{workflowID:e,nodeID:t})}static getChatLog(e){return this.post("getChatLog",{ChatSessionID:e})}}var m=h,v=o(1114);class g{}(0,v.A)(g,"guid",(function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,o="x"==e?t:3&t|8;return o.toString(16)}))}));var L=g;const F={key:0,width:"16",height:"16",viewBox:"0 0 32 32"},b=(0,a.Lk)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),f=[b],C={key:1,width:"16",height:"16",viewBox:"0 0 32 5"},D=(0,a.Lk)("path",{d:"M0 0h32v4.2H0z"},null,-1),y=[D],_={key:2,width:"16",height:"16",viewBox:"0 0 32 32"},I=(0,a.Lk)("path",{d:"M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6l6-6l-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"},null,-1),N=[I],w={key:3,width:"16",height:"16",viewBox:"0 0 24 24"},V=(0,a.Lk)("path",{d:"M14 20v-2h2.6l-3.2-3.2l1.425-1.425L18 16.55V14h2v6Zm-8.6 0L4 18.6L16.6 6H14V4h6v6h-2V7.4Zm3.775-9.425L4 5.4L5.4 4l5.175 5.175Z"},null,-1),j=[V],E={key:4,width:"16",height:"16",viewBox:"0 0 24 24"},x=(0,a.Lk)("path",{d:"M12 17q-2.075 0-3.537-1.463Q7 14.075 7 12t1.463-3.538Q9.925 7 12 7t3.538 1.462Q17 9.925 17 12q0 2.075-1.462 3.537Q14.075 17 12 17ZM2 13q-.425 0-.712-.288Q1 12.425 1 12t.288-.713Q1.575 11 2 11h2q.425 0 .713.287Q5 11.575 5 12t-.287.712Q4.425 13 4 13Zm18 0q-.425 0-.712-.288Q19 12.425 19 12t.288-.713Q19.575 11 20 11h2q.425 0 .712.287q.288.288.288.713t-.288.712Q22.425 13 22 13Zm-8-8q-.425 0-.712-.288Q11 4.425 11 4V2q0-.425.288-.713Q11.575 1 12 1t.713.287Q13 1.575 13 2v2q0 .425-.287.712Q12.425 5 12 5Zm0 18q-.425 0-.712-.288Q11 22.425 11 22v-2q0-.425.288-.712Q11.575 19 12 19t.713.288Q13 19.575 13 20v2q0 .425-.287.712Q12.425 23 12 23ZM5.65 7.05L4.575 6q-.3-.275-.288-.7q.013-.425.288-.725q.3-.3.725-.3t.7.3L7.05 5.65q.275.3.275.7q0 .4-.275.7q-.275.3-.687.287q-.413-.012-.713-.287ZM18 19.425l-1.05-1.075q-.275-.3-.275-.712q0-.413.275-.688q.275-.3.688-.287q.412.012.712.287L19.425 18q.3.275.288.7q-.013.425-.288.725q-.3.3-.725.3t-.7-.3ZM16.95 7.05q-.3-.275-.287-.688q.012-.412.287-.712L18 4.575q.275-.3.7-.288q.425.013.725.288q.3.3.3.725t-.3.7L18.35 7.05q-.3.275-.7.275q-.4 0-.7-.275ZM4.575 19.425q-.3-.3-.3-.725t.3-.7l1.075-1.05q.3-.275.713-.275q.412 0 .687.275q.3.275.288.688q-.013.412-.288.712L6 19.425q-.275.3-.7.287q-.425-.012-.725-.287Z"},null,-1),S=[x],M={key:5,width:"16",height:"16",viewBox:"0 0 24 24"},X=(0,a.Lk)("path",{d:"M12 21q-3.75 0-6.375-2.625T3 12q0-3.75 2.625-6.375T12 3q.35 0 .688.025q.337.025.662.075q-1.025.725-1.637 1.887Q11.1 6.15 11.1 7.5q0 2.25 1.575 3.825Q14.25 12.9 16.5 12.9q1.375 0 2.525-.613q1.15-.612 1.875-1.637q.05.325.075.662Q21 11.65 21 12q0 3.75-2.625 6.375T12 21Z"},null,-1),T=[X],U={key:6,width:"16",height:"16",viewBox:"0 0 24 24"},R=(0,a.Lk)("path",{d:"M20 19V7H4v12h16m0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16m-7 14v-2h5v2h-5m-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59l3.99-4Z"},null,-1),A=[R];var O={__name:"ToolIcon",props:{name:{type:String,required:!0}},setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,["zoomin"===e.name?((0,a.uX)(),(0,a.CE)("svg",F,f)):(0,a.Q3)("",!0),"zoomout"===e.name?((0,a.uX)(),(0,a.CE)("svg",C,y)):(0,a.Q3)("",!0),"reset"===e.name?((0,a.uX)(),(0,a.CE)("svg",_,N)):(0,a.Q3)("",!0),"update"===e.name?((0,a.uX)(),(0,a.CE)("svg",w,j)):(0,a.Q3)("",!0),"sun"===e.name?((0,a.uX)(),(0,a.CE)("svg",E,S)):(0,a.Q3)("",!0),"moon"===e.name?((0,a.uX)(),(0,a.CE)("svg",M,T)):(0,a.Q3)("",!0),"log"===e.name?((0,a.uX)(),(0,a.CE)("svg",U,A)):(0,a.Q3)("",!0)],64))}};const B=O;var Q=B;const P={key:0,class:"NodeToolBox"},K=(0,a.Lk)("div",{class:"title"},"选择节点",-1),q={class:"items iconfont"},W=["onClick"],J={class:"Name"},$=(0,a.Lk)("div",{class:"Icon RBt icon-jinrujiantouxiao"},null,-1);function H(e,t,o,l,s,d){return o.isVisible?((0,a.uX)(),(0,a.CE)("div",P,[K,(0,a.Lk)("div",q,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.NodeList.filter((e=>e.NodeClass==(1==o.nodeClass?"App":"Agent"))),((e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,onClick:t=>d.addNode(e.NodeType)},[(0,a.Lk)("div",{class:(0,n.C4)(["Icon",e.Icon])},null,2),(0,a.Lk)("div",J,(0,n.v_)(e.NodeName),1),$],8,W)))),128))])])])):(0,a.Q3)("",!0)}var z=o(8875),Z={name:"ToolBox",props:{node:Object,workflowID:String,mainID:String,isVisible:Boolean,nodeClass:Number},data(){return{NodeList:[{NodeName:"大模型",NodeType:"LargeModel",Icon:"icon-LargeModel",Description:"调用大语言模型，处理变量，配合提示词，生成输出",NodeClass:"Agent"},{NodeName:"知识库",NodeType:"KnowledgeBase",Icon:"icon-KnowledgeBase",Description:"根据输入的文本，调用知识库，获取知识库数据",NodeClass:"Agent"},{NodeName:"插件",NodeType:"Plugins",Icon:"icon-Plugins",Description:"插件可以提供更多能力，外部操作，获取外部数据等",NodeClass:"Agent"},{NodeName:"选择器",NodeType:"Selector",Icon:"icon-selector1",Description:"可以通过选择器的定义，链接多个下游执行节点",NodeClass:"Agent"},{NodeName:"Agent",NodeType:"Agent",Icon:"icon-Agent",Description:"调用Agent可以实现更多复杂组合",NodeClass:"App"},{NodeName:"时间触发器",NodeType:"TimeTrigger",Icon:"icon-TimeTrigger",Description:"可以定义一个特定时间点来触发下个节点",NodeClass:"App"}]}},methods:{addNode(e){m.addNode(e,this.workflowID,this.mainID).then((e=>{if(console.log(e),e.Status){var t=e.Data;this.$emit("addNode",t.Config)}else(0,z.me)({type:"warn",title:"Warn",text:e.ErrorDesc})}))}}},Y=o(1241);const G=(0,Y.A)(Z,[["render",H]]);var ee=G;const te={class:"Title"},oe={class:"LastUpdateTime"},le={class:"dialog-footer"};function ae(e,t,o,l,s,d){const i=(0,a.g2)("el-input"),u=(0,a.g2)("el-form-item"),c=(0,a.g2)("el-form"),p=(0,a.g2)("el-button"),r=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",{class:"WorkFlowInfo",onClick:t[0]||(t[0]=(...e)=>l.toggleDialog&&l.toggleDialog(...e))},[(0,a.Lk)("div",te,(0,n.v_)(o.info.WorkflowName),1),(0,a.Lk)("div",oe,(0,n.v_)(new Date(o.info.LastUpdateTime).toLocaleString()),1)]),(0,a.bF)(r,{modelValue:l.dialogFormVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>l.dialogFormVisible=e),title:"工作流信息",width:"500"},{footer:(0,a.k6)((()=>[(0,a.Lk)("div",le,[(0,a.bF)(p,{onClick:l.closeDialog},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1},8,["onClick"]),(0,a.bF)(p,{type:"primary",onClick:d.save},{default:(0,a.k6)((()=>[(0,a.eW)("保存")])),_:1},8,["onClick"])])])),default:(0,a.k6)((()=>[(0,a.bF)(c,{model:e.form,"label-width":"auto"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{label:"工作流名称","label-position":"right"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{modelValue:l.Info.WorkflowName,"onUpdate:modelValue":t[1]||(t[1]=e=>l.Info.WorkflowName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,a.bF)(u,{label:"说明","label-position":"right"},{default:(0,a.k6)((()=>[(0,a.bF)(i,{modelValue:l.Info.Description,"onUpdate:modelValue":t[2]||(t[2]=e=>l.Info.Description=e),"show-word-limit":"",maxlength:"128",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}var ne={name:"WorkFlowInfo",props:{node:Object,workflowID:String,isVisible:Boolean,info:Object},setup(e){const t=(0,d.KR)(!1),o=(0,d.KR)({});(0,a.sV)((()=>{o.value={...e.info}})),(0,a.wB)((()=>e.info),(e=>{o.value={...e}}),{immediate:!0});const l=()=>{t.value=!t.value},n=()=>{t.value=!1};return{dialogFormVisible:t,Info:o,toggleDialog:l,closeDialog:n}},methods:{show(){this.dialogFormVisible=!this.dialogFormVisible},save(){this.$emit("save",this.Info),this.dialogFormVisible=!1}}};const se=(0,Y.A)(ne,[["render",ae]]);var de=se;const ie={class:"WorkFlowData"},ue={class:"title"};function ce(e,t,o,l,s,d){return(0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("div",ue,(0,n.v_)(o.title),1)])}var pe={name:"WorkFlowData",props:{title:String}};const re=(0,Y.A)(pe,[["render",ce]]);var ke=re,he=o(8074);const me={class:"slider-input"},ve=["min","max"];function ge(e,t,o,s,d,i){return(0,a.uX)(),(0,a.CE)("div",me,[(0,a.bo)((0,a.Lk)("input",{type:"range",min:o.min,max:o.max,"onUpdate:modelValue":t[0]||(t[0]=e=>d.inputValue=e),onInput:t[1]||(t[1]=e=>i.updateValue(e.target.value)),onMousedown:t[2]||(t[2]=(0,l.D$)(((...e)=>s.handleRangeMouseDown&&s.handleRangeMouseDown(...e)),["stop"]))},null,40,ve),[[l.Jo,d.inputValue]]),(0,a.Lk)("span",null,(0,n.v_)(d.inputValue),1)])}var Le={props:{modelValue:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100}},setup(){const e=()=>{};return{handleRangeMouseDown:e}},data(){return{inputValue:this.modelValue}},watch:{modelValue(e){this.inputValue=e}},methods:{updateValue(e){this.inputValue=e,this.$emit("update:modelValue",e)}}};const Fe=(0,Y.A)(Le,[["render",ge]]);var be=Fe;const fe=e=>((0,a.Qi)("data-v-85d3eb4a"),e=e(),(0,a.jt)(),e),Ce={class:"Title"},De=fe((()=>(0,a.Lk)("span",{class:"Icon ticon icon-LargeModel"},null,-1))),ye=fe((()=>(0,a.Lk)("span",null,"大语言模型",-1))),_e={key:0,class:"Content"},Ie=fe((()=>(0,a.Lk)("div",{class:"Description"},"调用大语言模型，处理变量，配合提示词，生成输出",-1))),Ne={class:"LargeModel Content"},we={class:"Title"},Ve=fe((()=>(0,a.Lk)("span",null,"模型",-1))),je={key:0},Ee=["value"],xe={class:"Inputs Content"},Se={class:"Title"},Me=fe((()=>(0,a.Lk)("span",null,"提示词函数(插件)",-1))),Xe={key:0},Te={class:"Plugins Content"},Ue={class:"Title"},Re=fe((()=>(0,a.Lk)("span",null,"原生函数(插件)",-1))),Ae={key:0},Oe={class:"Inputs Content"},Be={class:"Title"},Qe=fe((()=>(0,a.Lk)("span",null,"输入变量",-1))),Pe={key:0},Ke=fe((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),qe=["onUpdate:modelValue","onChange"],We=fe((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Je=["value"],$e=["onUpdate:modelValue"],He=fe((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),ze=fe((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),Ze=fe((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),Ye=[He,ze,Ze],Ge=["onUpdate:modelValue"],et=["onClick","disabled"],tt={class:"Prompt Content"},ot={class:"Title"},lt=fe((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),at={key:0},nt=["placeholder"],st={class:"Coefficient Content"},dt={class:"Title"},it=fe((()=>(0,a.Lk)("span",null,"系数设置",-1))),ut={key:0},ct={class:"Outputs Content"},pt={class:"Title"},rt=fe((()=>(0,a.Lk)("span",null,"输出变量",-1))),kt={key:0},ht=fe((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述")],-1))),mt=["onUpdate:modelValue"],vt=["onUpdate:modelValue"],gt=fe((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),Lt=fe((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),Ft=fe((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),bt=[gt,Lt,Ft],ft=["onUpdate:modelValue"],Ct={name:"LargeModelNode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object,plugins:Object},components:{Multiselect:he.Ay,SliderInput:be},data(){return{label:this.data.label,nodeData:{...this.data,model:this.data.model||{LargeModelID:0,Name:"",ModelName:"",ModelKey:"",MICON:"",TypeCode:0,TypeName:"",ModelOrganizationID:0,ModelOrganizationName:"",EndPoint:"",MConfig:"",Description:"",SystemStatus:0},inputs:this.data.inputs||[{varname:"input",value:"",type:"string",txt:""}],prompt:this.data.prompt||"",temperature:this.data.temperature||70,topp:this.data.topp||80,output:this.data.output||[{varname:"results",value:"",type:"string",txt:""}],SemanticFunction:this.data.SemanticFunction||[],NativeFunction:this.data.NativeFunction||[]},largeModelList:this.largeModel,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_plugins:!0,isFold_plugins2:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},getInputPlaceholder(){return"请输入提示词："+this.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins},checkFoldPlugins2(){this.isFold_plugins2=!this.isFold_plugins2},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var Dt=Object.assign(Ct,{setup(e){return(t,o)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox LargeModelNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Ce,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),De,ye,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",_e,[Ie,(0,a.Lk)("div",Ne,[(0,a.Lk)("div",we,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldLargeModel&&t.checkFoldLargeModel(...e))},null,2),Ve]),t.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",je,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.largeModelList,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,Ee)))),128))],512),[[l.u1,t.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",xe,[(0,a.Lk)("div",Se,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldPlugins&&t.checkFoldPlugins(...e))},null,2),Me]),t.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Xe,[(0,a.bF)((0,d.R1)(he.Ay),{modelValue:t.nodeData.SemanticFunction,"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.SemanticFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.pluginsList.filter((e=>1==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Te,[(0,a.Lk)("div",Ue,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_plugins2?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[7]||(o[7]=(...e)=>t.checkFoldPlugins2&&t.checkFoldPlugins2(...e))},null,2),Re]),t.isFold_plugins2?((0,a.uX)(),(0,a.CE)("div",Ae,[(0,a.bF)((0,d.R1)(he.Ay),{modelValue:t.nodeData.NativeFunction,"onUpdate:modelValue":o[8]||(o[8]=e=>t.nodeData.NativeFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.pluginsList.filter((e=>2==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Oe,[(0,a.Lk)("div",Be,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Qe]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Pe,[(0,a.Lk)("table",null,[Ke,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[We,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Je)))),128))],40,qe),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[10]||(o[10]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},Ye,40,$e),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[11]||(o[11]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,Ge),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,et)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[12]||(o[12]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",tt,[(0,a.Lk)("div",ot,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[13]||(o[13]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),lt]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",at,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[14]||(o[14]=e=>t.nodeData.prompt=e),onMousedown:o[15]||(o[15]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[16]||(o[16]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:t.getInputPlaceholder()},null,40,nt),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",st,[(0,a.Lk)("div",dt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[17]||(o[17]=(...e)=>t.checkCoefficient&&t.checkCoefficient(...e))},null,2),it]),t.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",ut,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.temperature,"onUpdate:modelValue":o[18]||(o[18]=e=>t.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.topp,"onUpdate:modelValue":o[19]||(o[19]=e=>t.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ct,[(0,a.Lk)("div",pt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[20]||(o[20]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),rt]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",kt,[(0,a.Lk)("table",null,[ht,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:n},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t,onChange:o[21]||(o[21]=(...e)=>t.saveNode&&t.saveNode(...e))},null,40,mt),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[22]||(o[22]=(...e)=>t.saveNode&&t.saveNode(...e))},bt,40,vt),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[23]||(o[23]=(...e)=>t.saveNode&&t.saveNode(...e))},null,40,ft),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const yt=(0,Y.A)(Dt,[["__scopeId","data-v-85d3eb4a"]]);var _t=yt;const It=e=>((0,a.Qi)("data-v-3b988bc7"),e=e(),(0,a.jt)(),e),Nt={class:"Title"},wt=It((()=>(0,a.Lk)("span",{class:"Icon ticon icon-Plugins"},null,-1))),Vt=It((()=>(0,a.Lk)("span",null,"插件",-1))),jt={key:0,class:"Content"},Et=It((()=>(0,a.Lk)("div",{class:"Description"},"插件可以提供更多能力，外部操作，获取外部数据等",-1))),xt={class:"Plugins Content"},St={class:"Title"},Mt=It((()=>(0,a.Lk)("span",null,"插件",-1))),Xt={key:0},Tt=["value"],Ut={class:"Inputs Content"},Rt={class:"Title"},At=It((()=>(0,a.Lk)("span",null,"输入变量",-1))),Ot={key:0},Bt=It((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),Qt=["onUpdate:modelValue","onChange"],Pt=It((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Kt=["value"],qt=["onUpdate:modelValue"],Wt=It((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),Jt=It((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),$t=It((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),Ht=[Wt,Jt,$t],zt=["onUpdate:modelValue"],Zt=["onClick","disabled"],Yt={class:"Outputs Content"},Gt={class:"Title"},eo=It((()=>(0,a.Lk)("span",null,"输出",-1))),to={key:0},oo=It((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1))),lo=["onUpdate:modelValue"],ao=["onUpdate:modelValue"],no={name:"PluginsNode",props:{id:String,isSelected:Boolean,data:Object,plugins:Object},data(){return{label:this.data.label,nodeData:this.data,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_plugins:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var so=Object.assign(no,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox Plugins iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Nt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),wt,Vt,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",jt,[Et,(0,a.Lk)("div",xt,[(0,a.Lk)("div",St,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldPlugins&&t.checkFoldPlugins(...e))},null,2),Mt]),t.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Xt,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.plugins.PluginsID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.pluginsList.filter((e=>0==e.PluginsType)),((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.PluginsID},(0,n.v_)(e.Name),9,Tt)))),128))],512),[[l.u1,t.nodeData.plugins.PluginsID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ut,[(0,a.Lk)("div",Rt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),At]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Ot,[(0,a.Lk)("table",null,[Bt,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[Pt,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Kt)))),128))],40,Qt),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[6]||(o[6]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},Ht,40,qt),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[7]||(o[7]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,zt),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,Zt)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[8]||(o[8]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Yt,[(0,a.Lk)("div",Gt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),eo]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",to,[(0,a.Lk)("table",null,[oo,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,lo),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,ao),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const io=(0,Y.A)(so,[["__scopeId","data-v-3b988bc7"]]);var uo=io;const co={class:"Title"},po=(0,a.Lk)("span",{class:"Icon ticon icon-start"},null,-1),ro=(0,a.Lk)("span",null,"开始",-1),ko={key:0,class:"Content"},ho=(0,a.Lk)("div",{class:"Description"},"工作流的起始节点，用于设定启动工作流需要的信息",-1),mo={class:"Inputs Content"},vo={class:"Title"},go=(0,a.Lk)("span",null,"输入",-1),Lo={key:0},Fo=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),bo=["onUpdate:modelValue"],fo=["onUpdate:modelValue"],Co={class:"Prompt Content"},Do={class:"Title"},yo=(0,a.Lk)("span",null,"提示词",-1),_o={key:0},Io=["placeholder"],No={class:"Outputs Content"},wo={class:"Title"},Vo=(0,a.Lk)("span",null,"输出",-1),jo={key:0},Eo=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),xo=["onUpdate:modelValue"],So=["onUpdate:modelValue"],Mo={name:"StartNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var Xo=Object.assign(Mo,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox StartNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",co,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),po,ro]),t.isFold?((0,a.uX)(),(0,a.CE)("div",ko,[ho,(0,a.Lk)("div",mo,[(0,a.Lk)("div",vo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),go]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Lo,[(0,a.Lk)("table",null,[Fo,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,bo),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,fo),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Co,[(0,a.Lk)("div",Do,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[2]||(o[2]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),yo]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",_o,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[3]||(o[3]=e=>t.nodeData.prompt=e),onMousedown:o[4]||(o[4]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[5]||(o[5]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,Io),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",No,[(0,a.Lk)("div",wo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[6]||(o[6]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),Vo]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",jo,[(0,a.Lk)("table",null,[Eo,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,xo),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,So),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const To=Xo;var Uo=To;const Ro=e=>((0,a.Qi)("data-v-9d7e565c"),e=e(),(0,a.jt)(),e),Ao={class:"Title"},Oo=Ro((()=>(0,a.Lk)("span",{class:"Icon ticon icon-end"},null,-1))),Bo=Ro((()=>(0,a.Lk)("span",null,"结束",-1))),Qo={key:0,class:"Content"},Po=Ro((()=>(0,a.Lk)("div",{class:"Description"},"工作流的结束节点，用于返回工作流运行后的结果信息",-1))),Ko={class:"Inputs Content"},qo={class:"Title"},Wo=Ro((()=>(0,a.Lk)("span",null,"输入变量",-1))),Jo={key:0},$o=Ro((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),Ho=["onUpdate:modelValue","onChange"],zo=Ro((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Zo=["value"],Yo=["onUpdate:modelValue"],Go=Ro((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),el=Ro((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),tl=Ro((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),ol=[Go,el,tl],ll=["onUpdate:modelValue"],al=["onClick","disabled"],nl={class:"Prompt Content"},sl={class:"Title"},dl=Ro((()=>(0,a.Lk)("span",null,"组织返回结果",-1))),il={key:0},ul=["placeholder"],cl={name:"EndNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var pl=Object.assign(cl,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox EndNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Ao,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),Oo,Bo]),t.isFold?((0,a.uX)(),(0,a.CE)("div",Qo,[Po,(0,a.Lk)("div",Ko,[(0,a.Lk)("div",qo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Wo]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Jo,[(0,a.Lk)("table",null,[$o,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[zo,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Zo)))),128))],40,Ho),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[2]||(o[2]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},ol,40,Yo),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[3]||(o[3]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,ll),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,al)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[4]||(o[4]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",nl,[(0,a.Lk)("div",sl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),dl]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",il,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.prompt=e),onMousedown:o[7]||(o[7]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[8]||(o[8]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["需要将变量拼接在待返回的字符串中："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,ul),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const rl=(0,Y.A)(pl,[["__scopeId","data-v-9d7e565c"]]);var kl=rl;const hl=e=>((0,a.Qi)("data-v-09665cdd"),e=e(),(0,a.jt)(),e),ml={class:"Title"},vl=hl((()=>(0,a.Lk)("span",{class:"Icon ticon icon-selector1"},null,-1))),gl=hl((()=>(0,a.Lk)("span",null,"选择器",-1))),Ll={key:0,class:"Content"},Fl=hl((()=>(0,a.Lk)("div",{class:"Description"},"可以通过选择器的定义，链接多个下游执行节点",-1))),bl={class:"Inputs Content"},fl={class:"Title"},Cl=hl((()=>(0,a.Lk)("span",null,"输入变量",-1))),Dl={key:0},yl=hl((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),_l=["onUpdate:modelValue","onChange"],Il=hl((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Nl=["value"],wl=["onUpdate:modelValue"],Vl=hl((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),jl=hl((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),El=hl((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),xl=[Vl,jl,El],Sl=["onUpdate:modelValue"],Ml=["onClick","disabled"],Xl={class:"Selector Content"},Tl={class:"Title"},Ul=hl((()=>(0,a.Lk)("span",null,"条件判断",-1))),Rl={key:0},Al=hl((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"判断条件"),(0,a.Lk)("th",null,"比较值"),(0,a.Lk)("th",null,"删除")],-1))),Ol=["onUpdate:modelValue"],Bl=["value"],Ql=["onUpdate:modelValue"],Pl=["value"],Kl=["onUpdate:modelValue"],ql=["onClick"],Wl=hl((()=>(0,a.Lk)("span",{class:"Icon ticon icon-add"},null,-1))),Jl=hl((()=>(0,a.Lk)("span",null,"增加条件",-1))),$l=[Wl,Jl],Hl={name:"SelectorNode",props:{id:String,isSelected:Boolean,data:Object},created(){},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_selector:!0,selectorList:this.data.selector?this.data.selector.map(((e,t)=>({id:e.id||L.guid(),inputs:e.inputs||"2",comparison:e.comparison||"",value:e.value||"",varname:e.varname||"",top:25*t+240,top_str:"top:"+(25*t+240)+"px"}))):[],comparison:[{name:"等于",data:"=",text:"等于"},{name:"不等于",data:"!=",text:"不等于"},{name:"大于",data:">",text:"大于"},{name:"小于",data:"<",text:"小于"},{name:"包含",data:"~=",text:"包含"},{name:"不包含",data:"!~=",text:"不包含"}]}},methods:{resetHandleTop(){var e=80;this.isFold?(e+=40,this.isFold_inputs&&(e+=40,e+=48*(this.nodeData.inputs?.length||0)),this.isFold_selector?(e+=80,this.selectorList=this.selectorList.map(((t,o)=>{const l=e+48*o;return{...t,top:l+24,top_str:"top:"+(l+24)+"px"}}))):(e+=40,this.selectorList=this.selectorList.map((t=>({...t,top:e,top_str:"top:"+e+"px"}))))):(e=25,this.selectorList=this.selectorList.map((t=>({...t,top:e,top_str:"top:"+e+"px"}))))},saveNode(){const e=this.selectorList.map((e=>({id:e.id,inputs:e.inputs,comparison:e.comparison,value:e.value,varname:e.varname})));this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label,selector:e,inputs:this.nodeData.inputs||[]}}),this.$nextTick((()=>{this.resetHandleTop()}))},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold,this.resetHandleTop()},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs,this.resetHandleTop()},checkFoldSelector(){this.isFold_selector=!this.isFold_selector,this.resetHandleTop()},onAdd(){let e=80;if(this.isFold&&(e+=40,this.isFold_inputs&&(e+=40,e+=48*(this.nodeData.inputs?.length||0)),this.isFold_selector)){e+=80;const t=e+48*this.selectorList.length,o={id:L.guid(),inputs:"2",comparison:"",value:"",varname:"",top:t+24,top_str:"top:"+(t+24)+"px"};this.selectorList.push(o),this.saveNode()}},onDel(e){this.selectorList=this.selectorList.filter((t=>t.id!==e.id)),this.saveNode()},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var zl=Object.assign(Hl,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{id:"target_1",class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.selectorList,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[(0,a.bF)((0,d.R1)(i.h7),{id:e.id,class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:(0,n.Tr)(e.top_str)},null,8,["id","position","style"])])))),128)),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox SelectorNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",ml,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),vl,gl,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",Ll,[Fl,(0,a.Lk)("div",bl,[(0,a.Lk)("div",fl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Cl]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Dl,[(0,a.Lk)("table",null,[yl,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[Il,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Nl)))),128))],40,_l),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[4]||(o[4]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},xl,40,wl),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[5]||(o[5]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,Sl),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,Ml)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[6]||(o[6]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Xl,[(0,a.Lk)("div",Tl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_selector?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[7]||(o[7]=(...e)=>t.checkFoldSelector&&t.checkFoldSelector(...e))},null,2),Ul]),t.isFold_selector?((0,a.uX)(),(0,a.CE)("div",Rl,[(0,a.Lk)("table",null,[Al,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.selectorList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.varname},(0,n.v_)(e.varname),9,Bl)))),128))],8,Ol),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.comparison=t},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.comparison,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.name,value:e.data},(0,n.v_)(e.text),9,Pl)))),128))],8,Ql),[[l.u1,e.comparison]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{placeholder:"留空代表字符串空","onUpdate:modelValue":t=>e.value=t},null,8,Kl),[[l.Jo,e.value]])]),(0,a.Lk)("td",null,[(0,a.Lk)("span",{class:"Icon ticon icon-del del",onClick:o=>t.onDel(e)},null,8,ql)])])))),128))]),(0,a.Lk)("footer",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",{colspan:"4",class:"add",onClick:o[8]||(o[8]=(...e)=>t.onAdd&&t.onAdd(...e))},$l)])])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const Zl=(0,Y.A)(zl,[["__scopeId","data-v-09665cdd"]]);var Yl=Zl;const Gl=e=>((0,a.Qi)("data-v-ce17466a"),e=e(),(0,a.jt)(),e),ea={class:"Title"},ta=Gl((()=>(0,a.Lk)("span",{class:"Icon ticon icon-KnowledgeBase"},null,-1))),oa=Gl((()=>(0,a.Lk)("span",null,"知识库",-1))),la={key:0,class:"Content"},aa=Gl((()=>(0,a.Lk)("div",{class:"Description"},"根据输入的文本，调用知识库，获取知识库数据",-1))),na={class:"Inputs Content"},sa={class:"Title"},da=Gl((()=>(0,a.Lk)("span",null,"输入变量",-1))),ia={key:0},ua=Gl((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),ca=["onUpdate:modelValue","onChange"],pa=Gl((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),ra=["value"],ka=["onUpdate:modelValue"],ha=Gl((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),ma=Gl((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),va=Gl((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),ga=[ha,ma,va],La=["onUpdate:modelValue"],Fa=["onClick","disabled"],ba={class:"KnowledgeBase Content"},fa={class:"Title"},Ca=Gl((()=>(0,a.Lk)("span",null,"知识库",-1))),Da={key:0},ya={class:"LargeModel Content"},_a={class:"Title"},Ia=Gl((()=>(0,a.Lk)("span",null,"模型",-1))),Na={key:0},wa=["value"],Va={class:"Prompt Content"},ja={class:"Title"},Ea=Gl((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),xa={key:0},Sa=["placeholder"],Ma={class:"Coefficient Content"},Xa={class:"Title"},Ta=Gl((()=>(0,a.Lk)("span",null,"系数设置",-1))),Ua={key:0},Ra={class:"Outputs Content"},Aa={class:"Title"},Oa=Gl((()=>(0,a.Lk)("span",null,"输出",-1))),Ba={key:0},Qa=Gl((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1))),Pa=["onUpdate:modelValue"],Ka=["onUpdate:modelValue"],qa={name:"KnowledgeBaseNode",props:{id:String,isSelected:Boolean,data:Object,knowledgeBase:Object,largeModel:Object},components:{Multiselect:he.Ay,SliderInput:be},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,KnowledgeBaseList:this.knowledgeBase,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_KnowledgeBase:!0,isFold_Coefficient:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkFoldKnowledgeBase(){console.log(this.KnowledgeBaseList),this.isFold_KnowledgeBase=!this.isFold_KnowledgeBase},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var Wa=Object.assign(qa,{setup(e){return(t,o)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox KnowledgeBaseNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",ea,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),ta,oa,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",la,[aa,(0,a.Lk)("div",na,[(0,a.Lk)("div",sa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),da]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",ia,[(0,a.Lk)("table",null,[ua,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[pa,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,ra)))),128))],40,ca),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[4]||(o[4]=(...e)=>t.saveNode&&t.saveNode(...e))},ga,40,ka),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[5]||(o[5]=(...e)=>t.saveNode&&t.saveNode(...e))},null,40,La),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,Fa)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[6]||(o[6]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ba,[(0,a.Lk)("div",fa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_KnowledgeBase?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[7]||(o[7]=(...e)=>t.checkFoldKnowledgeBase&&t.checkFoldKnowledgeBase(...e))},null,2),Ca]),t.isFold_KnowledgeBase?((0,a.uX)(),(0,a.CE)("div",Da,[(0,a.bF)((0,d.R1)(he.Ay),{modelValue:t.nodeData.knowledgeBase,"onUpdate:modelValue":o[8]||(o[8]=e=>t.nodeData.knowledgeBase=e),placeholder:"请选择知识库",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.KnowledgeBaseList},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ya,[(0,a.Lk)("div",_a,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkFoldLargeModel&&t.checkFoldLargeModel(...e))},null,2),Ia]),t.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",Na,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[10]||(o[10]=e=>t.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.largeModelList,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,wa)))),128))],512),[[l.u1,t.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Va,[(0,a.Lk)("div",ja,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[11]||(o[11]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),Ea]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",xa,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[12]||(o[12]=e=>t.nodeData.prompt=e),onMousedown:o[13]||(o[13]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[14]||(o[14]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,Sa),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ma,[(0,a.Lk)("div",Xa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[15]||(o[15]=(...e)=>t.checkCoefficient&&t.checkCoefficient(...e))},null,2),Ta]),t.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",Ua,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.temperature,"onUpdate:modelValue":o[16]||(o[16]=e=>t.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.topp,"onUpdate:modelValue":o[17]||(o[17]=e=>t.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ra,[(0,a.Lk)("div",Aa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[18]||(o[18]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),Oa]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",Ba,[(0,a.Lk)("table",null,[Qa,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Pa),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Ka),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Ja=(0,Y.A)(Wa,[["__scopeId","data-v-ce17466a"]]);var $a=Ja;const Ha={class:"Title"},za=(0,a.Lk)("span",{class:"Icon ticon icon-start"},null,-1),Za=(0,a.Lk)("span",null,"开始",-1),Ya={key:0,class:"Content"},Ga=(0,a.Lk)("div",{class:"Description"},"工作流的起始节点，用于设定启动工作流需要的信息",-1),en={class:"Inputs Content"},tn={class:"Title"},on=(0,a.Lk)("span",null,"输入",-1),ln={key:0},an=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),nn=["onUpdate:modelValue"],sn=["onUpdate:modelValue"],dn={class:"Prompt Content"},un={class:"Title"},cn=(0,a.Lk)("span",null,"提示词",-1),pn={key:0},rn=["placeholder"],kn={class:"Outputs Content"},hn={class:"Title"},mn=(0,a.Lk)("span",null,"输出",-1),vn={key:0},gn=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),Ln=["onUpdate:modelValue"],Fn=["onUpdate:modelValue"],bn={name:"StartNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var fn=Object.assign(bn,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox StartNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Ha,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),za,Za]),t.isFold?((0,a.uX)(),(0,a.CE)("div",Ya,[Ga,(0,a.Lk)("div",en,[(0,a.Lk)("div",tn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),on]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",ln,[(0,a.Lk)("table",null,[an,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,nn),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,sn),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",dn,[(0,a.Lk)("div",un,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[2]||(o[2]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),cn]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",pn,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[3]||(o[3]=e=>t.nodeData.prompt=e),onMousedown:o[4]||(o[4]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[5]||(o[5]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,rn),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",kn,[(0,a.Lk)("div",hn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[6]||(o[6]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),mn]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",vn,[(0,a.Lk)("table",null,[gn,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Ln),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Fn),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const Cn=fn;var Dn=Cn;const yn=e=>((0,a.Qi)("data-v-647b44d0"),e=e(),(0,a.jt)(),e),_n={class:"Title"},In=yn((()=>(0,a.Lk)("span",{class:"Icon ticon icon-end"},null,-1))),Nn=yn((()=>(0,a.Lk)("span",null,"结束",-1))),wn={key:0,class:"Content"},Vn=yn((()=>(0,a.Lk)("div",{class:"Description"},"工作流的结束节点，用于返回工作流运行后的结果信息",-1))),jn={class:"Inputs Content"},En={class:"Title"},xn=yn((()=>(0,a.Lk)("span",null,"输入变量",-1))),Sn={key:0},Mn=yn((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),Xn=["onUpdate:modelValue","onChange"],Tn=yn((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Un=["value"],Rn=["onUpdate:modelValue"],An=yn((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),On=yn((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),Bn=yn((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),Qn=[An,On,Bn],Pn=["onUpdate:modelValue"],Kn=["onClick","disabled"],qn={class:"Prompt Content"},Wn={class:"Title"},Jn=yn((()=>(0,a.Lk)("span",null,"组织返回结果",-1))),$n={key:0},Hn=["placeholder"],zn={name:"AgentEndNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var Zn=Object.assign(zn,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox EndNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",_n,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),In,Nn]),t.isFold?((0,a.uX)(),(0,a.CE)("div",wn,[Vn,(0,a.Lk)("div",jn,[(0,a.Lk)("div",En,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[1]||(o[1]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),xn]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Sn,[(0,a.Lk)("table",null,[Mn,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[Tn,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Un)))),128))],40,Xn),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[2]||(o[2]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},Qn,40,Rn),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[3]||(o[3]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,Pn),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,Kn)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[4]||(o[4]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",qn,[(0,a.Lk)("div",Wn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),Jn]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",$n,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.prompt=e),onMousedown:o[7]||(o[7]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[8]||(o[8]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["需要将变量拼接在待返回的字符串中："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,Hn),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const Yn=(0,Y.A)(Zn,[["__scopeId","data-v-647b44d0"]]);var Gn=Yn;const es={class:"Title"},ts=(0,a.Lk)("span",{class:"Icon ticon icon-TimeTrigger"},null,-1),os=(0,a.Lk)("span",null,"时间触发器",-1),ls={key:0,class:"Content"},as=(0,a.Lk)("div",{class:"Description"},"可以定义一个特定时间点来触发下个节点",-1),ns={class:"TimeTrigger Content"},ss={class:"Title"},ds=(0,a.Lk)("span",null,"触发周期",-1),is={key:0},us={class:"Prompt Content"},cs={class:"Title"},ps=(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，作为下个节点的输入参数）",-1),rs={key:0},ks={class:"Outputs Content"},hs={class:"Title"},ms=(0,a.Lk)("span",null,"输出",-1),vs={key:0},gs=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),Ls=["onUpdate:modelValue"],Fs=["onUpdate:modelValue"],bs={name:"TimeTriggerNode",props:{id:String,isSelected:Boolean,data:Object},created(){},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_outputs:!0,isFold_TimeTrigger:!0,isFold_prompt:!0,loopType:[{name:"每隔n秒",data:"s",text:"每n秒"},{name:"每隔n天",data:"d",text:"每n天"},{name:"每周星期几",data:"w",text:"每周星期几"},{name:"每月第几日",data:"m",text:"每月第几日"}]}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold,this.resetHandleTop()},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldTimeTrigger(){this.isFold_TimeTrigger=!this.isFold_TimeTrigger,this.resetHandleTop()},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var fs=Object.assign(bs,{setup(e){return(t,o)=>{const s=(0,a.g2)("el-option"),u=(0,a.g2)("el-select"),c=(0,a.g2)("el-form-item"),p=(0,a.g2)("el-input"),r=(0,a.g2)("el-date-picker"),k=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox TimeTriggerNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",es,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),ts,os,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",ls,[as,(0,a.Lk)("div",ns,[(0,a.Lk)("div",ss,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_TimeTrigger?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldTimeTrigger&&t.checkFoldTimeTrigger(...e))},null,2),ds]),t.isFold_TimeTrigger?((0,a.uX)(),(0,a.CE)("div",is,[(0,a.bF)(k,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{label:"循环类型"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:t.nodeData.timeTrigger.loopType,"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.timeTrigger.loopType=e),placeholder:"循环类型"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.loopType,(e=>((0,a.uX)(),(0,a.Wv)(s,{key:e.name,value:e.data,label:e.text},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(c,{label:"周期"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{modelValue:t.nodeData.timeTrigger.IntervalValue,"onUpdate:modelValue":o[5]||(o[5]=e=>t.nodeData.timeTrigger.IntervalValue=e),type:"number",placeholder:"循环类型N的值"},null,8,["modelValue"])])),_:1}),(0,a.bF)(c,{label:"第一次开始时间",title:"循环类型为日、周、月时该值的时间'hh:mm'为每次循环的开始时间"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:t.nodeData.timeTrigger.StartTime,"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.timeTrigger.StartTime=e),type:"datetime",placeholder:"选择","default-time":t.defaultTime},null,8,["modelValue","default-time"])])),_:1}),(0,a.bF)(c,{label:"执行次数"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{modelValue:t.nodeData.timeTrigger.RepeatValue,"onUpdate:modelValue":o[7]||(o[7]=e=>t.nodeData.timeTrigger.RepeatValue=e),type:"number",placeholder:"0等于无限次"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",us,[(0,a.Lk)("div",cs,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[8]||(o[8]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),ps]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",rs,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[9]||(o[9]=e=>t.nodeData.prompt=e),onMousedown:o[10]||(o[10]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[11]||(o[11]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词：{{currentTime}}"]},null,544),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ks,[(0,a.Lk)("div",hs,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[12]||(o[12]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),ms]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",vs,[(0,a.Lk)("table",null,[gs,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,Ls),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,Fs),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Cs=fs;var Ds=Cs;const ys=e=>((0,a.Qi)("data-v-176b2774"),e=e(),(0,a.jt)(),e),_s={class:"Title"},Is=ys((()=>(0,a.Lk)("span",{class:"Icon ticon icon-Agent"},null,-1))),Ns=ys((()=>(0,a.Lk)("span",null,"Agent",-1))),ws={key:0,class:"Content"},Vs=ys((()=>(0,a.Lk)("div",{class:"Description"},"调用Agent可以实现更多复杂组合",-1))),js={class:"Agent Content"},Es={class:"Title"},xs=ys((()=>(0,a.Lk)("span",null,"Agent",-1))),Ss={key:0},Ms=["value"],Xs={class:"Inputs Content"},Ts={class:"Title"},Us=ys((()=>(0,a.Lk)("span",null,"输入变量",-1))),Rs={key:0},As=ys((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),Os=["onUpdate:modelValue","onChange"],Bs=ys((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Qs=["value"],Ps=["onUpdate:modelValue"],Ks=ys((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),qs=ys((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),Ws=ys((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),Js=[Ks,qs,Ws],$s=["onUpdate:modelValue"],Hs=["onClick","disabled"],zs={class:"Prompt Content"},Zs={class:"Title"},Ys=ys((()=>(0,a.Lk)("span",null,"Agent说明(让主控AI更好的理解Agent的作用，并合理安排触发任务)",-1))),Gs={key:0},ed=["placeholder"],td={class:"Outputs Content"},od={class:"Title"},ld=ys((()=>(0,a.Lk)("span",null,"输出",-1))),ad={key:0},nd=ys((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1))),sd=["onUpdate:modelValue"],dd=["onUpdate:modelValue"],id={name:"AgentNode",props:{id:String,isSelected:Boolean,data:Object,agents:Object},data(){return{label:this.data.label,nodeData:this.data,agentList:this.agents,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_Agent:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldAgent(){this.isFold_Agent=!this.isFold_Agent},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var ud=Object.assign(id,{setup(e){return(t,o)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox Agent iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",_s,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),Is,Ns,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",ws,[Vs,(0,a.Lk)("div",js,[(0,a.Lk)("div",Es,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_Agent?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldAgent&&t.checkFoldAgent(...e))},null,2),xs]),t.isFold_Agent?((0,a.uX)(),(0,a.CE)("div",Ss,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.agent.AgentID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.agentList,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.AgentID},(0,n.v_)(e.Name),9,Ms)))),128))],512),[[l.u1,t.nodeData.agent.AgentID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Xs,[(0,a.Lk)("div",Ts,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Us]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Rs,[(0,a.Lk)("table",null,[As,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[Bs,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Qs)))),128))],40,Os),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[6]||(o[6]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},Js,40,Ps),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[7]||(o[7]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,$s),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,Hs)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[8]||(o[8]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",zs,[(0,a.Lk)("div",Zs,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),Ys]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Gs,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[10]||(o[10]=e=>t.nodeData.prompt=e),onMousedown:o[11]||(o[11]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[12]||(o[12]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入Agent说明：输入参数:"+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(","),"输出参数:"+t.nodeData.output.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,ed),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",td,[(0,a.Lk)("div",od,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[13]||(o[13]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),ld]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",ad,[(0,a.Lk)("table",null,[nd,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,sd),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,dd),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64))}});const cd=(0,Y.A)(ud,[["__scopeId","data-v-176b2774"]]);var pd=cd;const rd=e=>((0,a.Qi)("data-v-5431ea28"),e=e(),(0,a.jt)(),e),kd={class:"Title"},hd=rd((()=>(0,a.Lk)("span",{class:"Icon ticon icon-MainAI"},null,-1))),md=rd((()=>(0,a.Lk)("span",null,"主控AI",-1))),vd={key:0,class:"Content"},gd=rd((()=>(0,a.Lk)("div",{class:"Description"},"主导应用的核心AI，可以调用多个Agent",-1))),Ld={class:"LargeModel Content"},Fd={class:"Title"},bd=rd((()=>(0,a.Lk)("span",null,"模型",-1))),fd={key:0},Cd=["value"],Dd={class:"Inputs Content"},yd={class:"Title"},_d=rd((()=>(0,a.Lk)("span",null,"提示词函数(插件)",-1))),Id={key:0},Nd={class:"Plugins Content"},wd={class:"Title"},Vd=rd((()=>(0,a.Lk)("span",null,"原生函数(插件)",-1))),jd={key:0},Ed={class:"Inputs Content"},xd={class:"Title"},Sd=rd((()=>(0,a.Lk)("span",null,"输入变量",-1))),Md={key:0},Xd=rd((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th",null,"操作")],-1))),Td=["onUpdate:modelValue","onChange"],Ud=rd((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Rd=["value"],Ad=["onUpdate:modelValue"],Od=rd((()=>(0,a.Lk)("option",{value:"string"},"字符串",-1))),Bd=rd((()=>(0,a.Lk)("option",{value:"number"},"数字",-1))),Qd=rd((()=>(0,a.Lk)("option",{value:"boolean"},"布尔值",-1))),Pd=[Od,Bd,Qd],Kd=["onUpdate:modelValue"],qd=["onClick","disabled"],Wd={class:"Prompt Content"},Jd={class:"Title"},$d=rd((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),Hd={key:0},zd=["placeholder"],Zd={class:"Coefficient Content"},Yd={class:"Title"},Gd=rd((()=>(0,a.Lk)("span",null,"系数设置",-1))),ei={key:0},ti={class:"Outputs Content"},oi={class:"Title"},li=rd((()=>(0,a.Lk)("span",null,"输出",-1))),ai={key:0},ni=rd((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1))),si=["onUpdate:modelValue"],di=["onUpdate:modelValue"],ii={name:"MainAINode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object,plugins:Object},components:{Multiselect:he.Ay,SliderInput:be},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_mainAI:!0,isFold_plugins:!0,isFold_plugins2:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldMainAI(){this.isFold_mainAI=!this.isFold_mainAI},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins},checkFoldPlugins2(){this.isFold_plugins2=!this.isFold_plugins2},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient},onVarnameSelect(e,t){if(e.varname=t,this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes)){const l=o.output.find((e=>e.varname===t));if(l){e.type=l.type||"string",e.txt=l.txt||"";break}}this.saveNode()},getAvailableVarnames(e){const t=[],o=this.nodeData.inputs.map(((t,o)=>o!==e?t.varname:null)).filter(Boolean);if(this.data.sourceNodes)for(const l of Object.values(this.data.sourceNodes))l.output&&l.output.forEach((e=>{e.varname&&!o.includes(e.varname)&&t.push({varname:e.varname,nodeId:l.nodeId,label:l.label})}));return t},addInput(){this.nodeData.inputs.push({varname:"",type:"string",txt:""})},removeInput(e){this.nodeData.inputs.splice(e,1),0===this.nodeData.inputs.length&&this.addInput(),this.saveNode()}},watch:{"data.sourceNodes":{handler(e,t){if(t){const o=Object.keys(t).filter((t=>!e||!e[t]));if(o.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of o){const o=t[n];if(o.output&&o.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let t=e.length-1;t>=0;t--)this.nodeData.inputs.splice(e[t],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var ui=Object.assign(ii,{setup(e){return(t,o)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"target",position:(0,d.R1)(i.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,d.R1)(i.h7),{class:"Handle",type:"source",position:(0,d.R1)(i.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox MainAINode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",kd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),hd,md,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",vd,[gd,(0,a.Lk)("div",Ld,[(0,a.Lk)("div",Fd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_mainAI?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldMainAI&&t.checkFoldMainAI(...e))},null,2),bd]),t.isFold_mainAI?((0,a.uX)(),(0,a.CE)("div",fd,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.largeModelList,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,Cd)))),128))],512),[[l.u1,t.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Dd,[(0,a.Lk)("div",yd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldPlugins&&t.checkFoldPlugins(...e))},null,2),_d]),t.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Id,[(0,a.bF)((0,d.R1)(he.Ay),{modelValue:t.nodeData.SemanticFunction,"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.SemanticFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.pluginsList.filter((e=>1==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Nd,[(0,a.Lk)("div",wd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_plugins2?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[7]||(o[7]=(...e)=>t.checkFoldPlugins2&&t.checkFoldPlugins2(...e))},null,2),Vd]),t.isFold_plugins2?((0,a.uX)(),(0,a.CE)("div",jd,[(0,a.bF)((0,d.R1)(he.Ay),{modelValue:t.nodeData.NativeFunction,"onUpdate:modelValue":o[8]||(o[8]=e=>t.nodeData.NativeFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:t.pluginsList.filter((e=>2==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ed,[(0,a.Lk)("div",xd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkFoldInputs&&t.checkFoldInputs(...e))},null,2),Sd]),t.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Md,[(0,a.Lk)("table",null,[Xd,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.inputs,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.varname=t,onChange:o=>t.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[Ud,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.getAvailableVarnames(s),(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.nodeId+"_"+e.varname,value:e.varname},(0,n.v_)(e.varname)+" (来自节点: "+(0,n.v_)(e.label||e.nodeId)+") ",9,Rd)))),128))],40,Td),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.type=t,onChange:o[10]||(o[10]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"TypeSelect"},Pd,40,Ad),[[l.u1,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t,onChange:o[11]||(o[11]=(...e)=>t.saveNode&&t.saveNode(...e)),class:"DescInput"},null,40,Kd),[[l.Jo,e.txt]])]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"DeleteBtn",onClick:e=>t.removeInput(s),disabled:t.nodeData.inputs.length<=1,title:"至少保留一个输入变量"}," 删除 ",8,qd)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[12]||(o[12]=(...e)=>t.addInput&&t.addInput(...e))},"+")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Wd,[(0,a.Lk)("div",Jd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[13]||(o[13]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),$d]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Hd,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[14]||(o[14]=e=>t.nodeData.prompt=e),onMousedown:o[15]||(o[15]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[16]||(o[16]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,zd),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Zd,[(0,a.Lk)("div",Yd,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[17]||(o[17]=(...e)=>t.checkCoefficient&&t.checkCoefficient(...e))},null,2),Gd]),t.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",ei,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.temperature,"onUpdate:modelValue":o[18]||(o[18]=e=>t.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.topp,"onUpdate:modelValue":o[19]||(o[19]=e=>t.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ti,[(0,a.Lk)("div",oi,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[20]||(o[20]=(...e)=>t.checkFoldOutputs&&t.checkFoldOutputs(...e))},null,2),li]),t.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",ai,[(0,a.Lk)("table",null,[ni,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.nodeData.output,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.varname=t},null,8,si),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.txt=t},null,8,di),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const ci=(0,Y.A)(ui,[["__scopeId","data-v-5431ea28"]]);var pi=ci,ri=o(7477);const ki={class:"Title"},hi=(0,a.Lk)("span",{class:"Icon ticon icon-Reporter"},null,-1),mi=(0,a.Lk)("span",null,"记录员",-1),vi={key:0,class:"Content"},gi=(0,a.Lk)("div",{class:"Description"}," 调用大语言模型，记录会话内容，并进行必要的摘要与整理，减少回话上下文长度，提高会话质量 ",-1),Li={class:"LargeModel Content"},Fi={class:"Title"},bi=(0,a.Lk)("span",null,"模型",-1),fi={key:0},Ci=["value"],Di={class:"Prompt Content"},yi={class:"Title"},_i=(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1),Ii={key:0},Ni=["placeholder"],wi={class:"Coefficient Content"},Vi={class:"Title"},ji=(0,a.Lk)("span",null,"系数设置",-1),Ei={key:0},xi={name:"ReporterNode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object},components:{SliderInput:be},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient}}};var Si=Object.assign(xi,{setup(e){return(t,o)=>{const s=(0,a.g2)("el-switch"),i=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)("div",{class:(0,n.C4)(["NodeBox ReporterNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",ki,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>t.checkFold&&t.checkFold(...e))},null,2),hi,mi,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":o[1]||(o[1]=e=>t.label=e),value:"{{label}}",placeholder:"备注",onBlur:o[2]||(o[2]=(...e)=>t.saveLabel&&t.saveLabel(...e))},null,544),[[l.Jo,t.label]])]),t.isFold?((0,a.uX)(),(0,a.CE)("div",vi,[gi,(0,a.Lk)("div",Li,[(0,a.Lk)("div",Fi,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[3]||(o[3]=(...e)=>t.checkFoldLargeModel&&t.checkFoldLargeModel(...e))},null,2),bi]),t.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",fi,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>t.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.largeModelList,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,Ci)))),128))],512),[[l.u1,t.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Di,[(0,a.Lk)("div",yi,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[5]||(o[5]=(...e)=>t.checkFoldPrompt&&t.checkFoldPrompt(...e))},null,2),_i]),t.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Ii,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":o[6]||(o[6]=e=>t.nodeData.prompt=e),onMousedown:o[7]||(o[7]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),onWheel:o[8]||(o[8]=(0,l.D$)(((...e)=>t.handleRangeMouseDown&&t.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+t.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,Ni),[[l.Jo,t.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",wi,[(0,a.Lk)("div",Vi,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[t.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[9]||(o[9]=(...e)=>t.checkCoefficient&&t.checkCoefficient(...e))},null,2),ji]),t.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",Ei,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(i,{label:"是否启用"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{modelValue:t.nodeData.enable,"onUpdate:modelValue":o[10]||(o[10]=e=>t.nodeData.enable=e),class:"mt-2",style:{"margin-left":"10px"},"inline-prompt":"","active-icon":(0,d.R1)(ri.Jlk),"inactive-icon":(0,d.R1)(ri.bm)},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,a.bF)(i,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.temperature,"onUpdate:modelValue":o[11]||(o[11]=e=>t.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(i,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.topp,"onUpdate:modelValue":o[12]||(o[12]=e=>t.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(i,{label:"每次总结记录数(会话条数)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:t.nodeData.recordslength,"onUpdate:modelValue":o[13]||(o[13]=e=>t.nodeData.recordslength=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)}}});const Mi=Si;var Xi=Mi;const Ti=["cx","cy"],Ui=["d"],Ri=["transform","d"],Ai={inheritAttrs:!1};var Oi=Object.assign(Ai,{__name:"CustomEdge",props:{id:{type:String,required:!0},sourceX:{type:Number,required:!0},sourceY:{type:Number,required:!0},targetX:{type:Number,required:!0},targetY:{type:Number,required:!0},sourcePosition:{type:String,required:!0},targetPosition:{type:String,required:!0},data:{type:Object,required:!1},markerEnd:{type:String,required:!1},style:{type:Object,required:!1}},setup(e){const t=e,o=(0,a.EW)((()=>(0,i.Fp)(t)));return(l,s)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,d.R1)(i.tE),{id:e.id,style:(0,n.Tr)(e.style),path:o.value[0],"marker-end":e.markerEnd,label:e.data.text,"label-x":o.value[1],"label-y":o.value[2],"label-style":{fill:"white"},"label-show-bg":!0,"label-bg-style":{fill:"red"},"label-bg-padding":[2,4],"label-bg-border-radius":2},null,8,["id","style","path","marker-end","label","label-x","label-y"]),(0,a.Lk)("g",null,[(0,a.Lk)("circle",{cx:t.sourceX,cy:t.sourceY,r:"4",fill:"#29a3ff"},null,8,Ti),(0,a.Lk)("path",{d:o.value,fill:"none",stroke:"#29a3ff","stroke-width":"2"},null,8,Ui),(0,a.Lk)("path",{transform:l.transform,d:`M ${e.targetX} ${e.targetY+2} L ${e.targetX-5} ${e.targetY-10} L ${e.targetX+5} ${e.targetY-10} Z`,fill:"#3e47de",stroke:"none"},null,8,Ri)])],64))}});const Bi=Oi;var Qi=Bi,Pi=null,Ki={name:"WorkFlow",props:{baseURL:String,workflow_data:{title:"智能助理",info:null,WorkFlowID:"",MainID:"",MainType:2}},components:{VueFlow:i.nO,Background:u.V,MiniMap:p.of,ToolBox:ee,WorkFlowInfo:de,Controls:c.H,ToolIcon:Q,ControlButton:c.a,WorkFlowData:ke,LargeModelNode:_t,PluginsNode:uo,StartNode:Uo,EndNode:kl,AgentStartNode:Dn,AgentEndNode:Gn,SelectorNode:Yl,TimeTrigger:Ds,AgentNode:pd,MainAINode:pi,ReporterNode:Xi,CustomEdge:Qi,KnowledgeBaseNode:$a},setup(){const{onInit:e,onNodeDragStop:t,onConnect:o,addEdges:l,setViewport:a,toObject:n,onNodesChange:s,applyNodeChanges:u,onEdgesChange:c,applyEdgeChanges:p}=(0,i.Id)();e((e=>{e.fitView()})),t((()=>{Pi.nodes=n().nodes})),o((e=>{e.id=L.guid(),e.markerEnd=i.TG.ArrowClosed,e.style="stroke-width: 3;stroke:#3e47de;";const t=Pi.nodes.find((t=>t.id===e.source)),o=Pi.nodes.find((t=>t.id===e.target));t?.data?.output&&(o.data.sourceNodes||(o.data.sourceNodes={}),o.data.sourceNodes[t.id]={nodeId:t.id,label:t.data.label,output:t.data.output}),l(e),Pi.edges=n().edges})),s((e=>{const t=[];for(const l of e)if("remove"===l.type){var o=Pi.nodes.filter((e=>e.id===l.id));if(o.length>0){if("Start"===o[0].type||"AgentStart"===o[0].type){(0,z.me)({type:"warn",title:"开始节点不能删除"});continue}if("End"===o[0].type||"AgentEnd"===o[0].type){(0,z.me)({type:"warn",title:"结束节点不能删除"});continue}if("MainAI"===o[0].type){(0,z.me)({type:"warn",title:"应用用主控AI不能删除"});continue}if("Reporter"===o[0].type){(0,z.me)({type:"warn",title:"应用记录员不能删除"});continue}t.push(l)}}else t.push(l);u(t)})),c((e=>{const t=[];for(const o of e)if("remove"===o.type){if(Pi.selectedNode)continue;{const e=Pi.edges.find((e=>e.id===o.id));if(e){const t=Pi.nodes.find((t=>t.id===e.target));t?.data?.sourceNodes&&delete t.data.sourceNodes[e.source]}t.push(o)}}else t.push(o);p(t)}));const r=(0,d.KR)(a),k=(0,d.KR)(n);return{_setViewport:r,_toObject:k}},mounted(){let e=this;this.init(),this.startInterval(),Pi=e},unmount(){this.stopInterval()},data(){return{ShowNodeBox:!1,workflow:{title:this.workflow_data.title,info:this.workflow_data.info},info:{},pluginsList:[],largeModelList:[],knowledgeBaseList:[],agentList:[],nodes:[],edges:[],dark:(0,d.KR)(!1),selectedNode:null,selectEdge:null,connectionLineStyle:{stroke:"#ddd",strokeWidth:3},intervalId:null}},methods:{logToObject(){this.save()},resetTransform(){this._setViewport({x:0,y:0,zoom:1})},onShowNodeBox(){this.ShowNodeBox=!this.ShowNodeBox},toggleDarkMode(){this.dark=!this.dark},addNode(e){console.log(e),this.nodes.push(e)},saveNode(e){this.nodes=this.nodes.map((t=>(t.id==e.id&&(t.data=e.data),t)))},nodeClick(e){this.selectedNode=e,this.selectEdge=null},edgeClick(e){this.selectedNode=null,this.selectEdge=e},startInterval(){this.intervalId=setInterval(this.save,5e3)},stopInterval(){this.intervalId&&clearInterval(this.intervalId)},async init(){m.getBaseConfig().then((e=>{if(console.log(e),e.Status){var t=e.Data;this.largeModelList=(0,d.KR)(t.largeModelList),this.pluginsList=t.pluginsList,this.agentList=t.agentList,this.knowledgeBaseList=t.knowledgeBaseList}this.getWorkFlow()})).catch((e=>{console.log(e)}))},getWorkFlow(){var e=this;m.getWorkFlow(e.workflow_data.WorkFlowID,e.workflow_data.MainID,e.workflow_data.MainType).then((e=>{if(e.Status){var t=e.Data;this.info=Object.assign({},this.info,t.Info),t.Nodes.map((e=>{this.nodes.push(e.Config)})),t.Edges.map((e=>{this.edges.push(e.Config)})),this.$forceUpdate()}})).catch((e=>{console.log(e)}))},save(e=null){var t=this,o=t.workflow_data.WorkFlowID,l=t.info;null!=e&&(l.WorkflowName=e.WorkflowName,l.Description=e.Description);var a=this._toObject().nodes.map((e=>({NodeID:e.id,WorkFlowID:o,NodeType:e.type,NodeName:e.data.label,Description:e.data.label,Config:e}))),n=this._toObject().edges.map((e=>({EdgeID:e.id,WorkFlowID:o,SourceNodeId:e.source,TargetNodeId:e.target,Condition:"",LName:"",Config:e}))),s={Info:l,Nodes:a,Edges:n,WorkFlowID:o,MainID:t.workflow_data.MainID,MainType:t.workflow_data.MainType};m.subWorkFlow(s).then((e=>{console.log(e),e.Status&&(t.workflow_data.WorkFlowID=e.Data,t.info.LastUpdateTime=(new Date).toLocaleString())})).catch((e=>{console.log(e)}))}}};const qi=(0,Y.A)(Ki,[["render",s]]);var Wi=qi;const Ji={name:"App",props:{initParams:null},components:{WorkFlow:Wi},created(){this.parseUrlParams()},methods:{parseUrlParams(){const e=new URLSearchParams(window.location.search);this.workflow_data.WorkFlowID=e.get("WorkFlowID"),this.workflow_data.MainID=e.get("MainID"),this.workflow_data.MainType=e.get("MainType"),this.baseURL=e.get("baseURL")}},data(){return{baseURL:"",workflow_data:{title:"工作流",info:null,WorkFlowID:"",MainID:"",MainType:2}}}};var $i=Object.assign(Ji,{setup(e){return(e,t)=>{const o=(0,a.g2)("notifications");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(Wi,{workflow_data:e.workflow_data,baseURL:e.baseURL},null,8,["workflow_data","baseURL"]),(0,a.bF)(o)],64)}}});const Hi=$i;var zi=Hi,Zi=o(4651);o(4188);const Yi=window.chatParams||{},Gi=(0,l.Ef)(zi,{initParams:Yi});Gi.use(Zi.A),Gi.use(z.Ay),Gi.mount("#app")}},t={};function o(l){var a=t[l];if(void 0!==a)return a.exports;var n=t[l]={exports:{}};return e[l].call(n.exports,n,n.exports,o),n.exports}o.m=e,function(){var e=[];o.O=function(t,l,a,n){if(!l){var s=1/0;for(c=0;c<e.length;c++){l=e[c][0],a=e[c][1],n=e[c][2];for(var d=!0,i=0;i<l.length;i++)(!1&n||s>=n)&&Object.keys(o.O).every((function(e){return o.O[e](l[i])}))?l.splice(i--,1):(d=!1,n<s&&(s=n));if(d){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[l,a,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,n,s=l[0],d=l[1],i=l[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(a in d)o.o(d,a)&&(o.m[a]=d[a]);if(i)var c=i(o)}for(t&&t(l);u<s.length;u++)n=s[u],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(c)},l=self["webpackChunkworkflow"]=self["webpackChunkworkflow"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=o.O(void 0,[504],(function(){return o(2436)}));l=o.O(l)})();
//# sourceMappingURL=app.bbeef78e.js.map