(function(){"use strict";var e={6649:function(e,o,t){var l=t(5130),a=(t(4603),t(7566),t(8721),t(6768)),n=t(4232);function s(e,o,t,l,s,i){const d=(0,a.g2)("Background"),u=(0,a.g2)("WorkFlowData"),c=(0,a.g2)("MiniMap"),r=(0,a.g2)("ToolIcon"),p=(0,a.g2)("ControlButton"),h=(0,a.g2)("Controls"),k=(0,a.g2)("WorkFlowInfo"),m=(0,a.g2)("Panel"),g=(0,a.g2)("ToolBox"),v=(0,a.g2)("CustomEdge"),F=(0,a.g2)("StartNode"),L=(0,a.g2)("EndNode"),b=(0,a.g2)("AgentStartNode"),f=(0,a.g2)("AgentEndNode"),C=(0,a.g2)("LargeModelNode"),y=(0,a.g2)("KnowledgeBaseNode"),_=(0,a.g2)("PluginsNode"),N=(0,a.g2)("SelectorNode"),D=(0,a.g2)("TimeTrigger"),I=(0,a.g2)("MainAINode"),w=(0,a.g2)("AgentNode"),V=(0,a.g2)("ReporterNode"),S=(0,a.g2)("VueFlow");return(0,a.uX)(),(0,a.Wv)(S,{ref:"vueFlow",nodes:s.nodes,edges:s.edges,class:(0,n.C4)([{dark:s.dark},"basic-flow"]),"default-viewport":{zoom:1.5},"min-zoom":.2,"max-zoom":4,"apply-default":!1,"fit-view-on-init":"",onNodesChange:e.onNodesChange,onEdgesChange:e.onEdgesChange,onEdgeClick:i.edgeClick,onNodeClick:i.nodeClick,"connection-line-style":s.connectionLineStyle},{"edge-custom":(0,a.k6)((e=>[(0,a.bF)(v,{id:e.id,"source-x":e.sourceX,"source-y":e.sourceY,"target-x":e.targetX,"target-y":e.targetY,"source-position":e.sourcePosition,"target-position":e.targetPosition,data:e.data,"marker-end":e.markerEnd,style:(0,n.Tr)(e.style)},null,8,["id","source-x","source-y","target-x","target-y","source-position","target-position","data","marker-end","style"])])),"node-Start":(0,a.k6)((e=>[(0,a.bF)(F,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-End":(0,a.k6)((e=>[(0,a.bF)(L,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-AgentStart":(0,a.k6)((e=>[(0,a.bF)(b,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-AgentEnd":(0,a.k6)((e=>[(0,a.bF)(f,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-LargeModel":(0,a.k6)((e=>[(0,a.bF)(C,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,plugins:s.pluginsList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","largeModel","plugins","onSaveNode"])])),"node-KnowledgeBase":(0,a.k6)((e=>[(0,a.bF)(y,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,knowledgeBase:s.knowledgeBaseList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","largeModel","knowledgeBase","onSaveNode"])])),"node-Plugins":(0,a.k6)((e=>[(0,a.bF)(_,{id:e.id,data:e.data,isSelected:e.selected,plugins:s.pluginsList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","plugins","onSaveNode"])])),"node-Selector":(0,a.k6)((e=>[(0,a.bF)(N,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-TimeTrigger":(0,a.k6)((e=>[(0,a.bF)(D,{id:e.id,data:e.data,isSelected:e.selected,onSaveNode:i.saveNode},null,8,["id","data","isSelected","onSaveNode"])])),"node-MainAI":(0,a.k6)((e=>[(0,a.bF)(I,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,plugins:s.pluginsList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","largeModel","plugins","onSaveNode"])])),"node-Agent":(0,a.k6)((e=>[(0,a.bF)(w,{id:e.id,data:e.data,isSelected:e.selected,agents:s.agentList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","agents","onSaveNode"])])),"node-Reporter":(0,a.k6)((e=>[(0,a.bF)(V,{id:e.id,data:e.data,isSelected:e.selected,largeModel:s.largeModelList,onSaveNode:i.saveNode},null,8,["id","data","isSelected","largeModel","onSaveNode"])])),default:(0,a.k6)((()=>[(0,a.bF)(d,{"pattern-color":"#f0f0f0",gap:15}),(0,a.bF)(u,{class:"vue-flow__panel top left"}),(0,a.bF)(c,{position:"bottom-left",class:"MiniMap"}),(0,a.bF)(h,{position:"bottom-left"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{title:"Reset Transform",onClick:i.resetTransform},{default:(0,a.k6)((()=>[(0,a.bF)(r,{name:"reset"})])),_:1},8,["onClick"]),(0,a.bF)(p,{title:"Toggle Dark Mode",onClick:i.toggleDarkMode},{default:(0,a.k6)((()=>[s.dark?((0,a.uX)(),(0,a.Wv)(r,{key:0,name:"sun"})):((0,a.uX)(),(0,a.Wv)(r,{key:1,name:"moon"}))])),_:1},8,["onClick"]),(0,a.bF)(p,{title:"Log `toObject`",onClick:i.logToObject},{default:(0,a.k6)((()=>[(0,a.bF)(r,{name:"log"})])),_:1},8,["onClick"])])),_:1}),(0,a.bF)(m,{class:"WorkFlowInfo vue-flow__panel top left vue-flow__controls"},{default:(0,a.k6)((()=>[(0,a.bF)(k,{info:s.info,"onUpdate:info":o[0]||(o[0]=e=>s.info=e),onSave:i.save},null,8,["info","onSave"])])),_:1}),(0,a.bF)(m,{class:"ToolBox vue-flow__panel top left vue-flow__controls"},{default:(0,a.k6)((()=>[(0,a.bF)(g,{"is-visible":s.ShowNodeBox,"workflow-i-d":t.workflow_data.WorkFlowID,"main-i-d":t.workflow_data.MainID,nodeClass:t.workflow_data.MainType,onAddNode:i.addNode},null,8,["is-visible","workflow-i-d","main-i-d","nodeClass","onAddNode"]),(0,a.bF)(p,{onClick:i.onShowNodeBox},{default:(0,a.k6)((()=>[s.ShowNodeBox?((0,a.uX)(),(0,a.Wv)(r,{key:1,name:"zoomout"})):((0,a.uX)(),(0,a.Wv)(r,{key:0,name:"zoomin"}))])),_:1},8,["onClick"])])),_:1})])),_:1},8,["nodes","edges","class","onNodesChange","onEdgesChange","onEdgeClick","onNodeClick","connection-line-style"])}t(4114);var i=t(144),d=t(6805),u=t(2647),c=t(4671),r=t(4039),p=t(4373);const h=p.A.create({baseURL:"/",headers:{"Content-Type":"application/json"}});class k{static get(e){return h.get(e).then((e=>e.data))}static post(e,o,t){return h.post(e,o,t).then((e=>e.data))}static put(e,o){return h.put(e,o).then((e=>e.data))}static delete(e){return h.delete(e).then((()=>!0))}static getBaseConfig(){return this.get("/Manage/Workflow/getBaseConfig")}static getWorkFlow(e,o,t){return this.post("/Manage/Workflow/getWorkFlow",{WorkflowID:e,MainID:o,MainType:t},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static addNode(e,o,t){return this.post("/Manage/Workflow/addNode",{WorkflowID:o,NodeType:e,MainID:t},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})}static subWorkFlow(e){return this.post("/Manage/Workflow/Save",e,{headers:{"Content-Type":"application/json"}})}static getNodeExcutionRecord(e,o){return this.post("getNodeExcutionRecord",{workflowID:e,nodeID:o})}static getChatLog(e){return this.post("getChatLog",{ChatSessionID:e})}}var m=k,g=t(1114);class v{}(0,g.A)(v,"guid",(function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=16*Math.random()|0,t="x"==e?o:3&o|8;return t.toString(16)}))}));var F=v;const L={key:0,width:"16",height:"16",viewBox:"0 0 32 32"},b=(0,a.Lk)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"},null,-1),f=[b],C={key:1,width:"16",height:"16",viewBox:"0 0 32 5"},y=(0,a.Lk)("path",{d:"M0 0h32v4.2H0z"},null,-1),_=[y],N={key:2,width:"16",height:"16",viewBox:"0 0 32 32"},D=(0,a.Lk)("path",{d:"M18 28A12 12 0 1 0 6 16v6.2l-3.6-3.6L1 20l6 6l6-6l-1.4-1.4L8 22.2V16a10 10 0 1 1 10 10Z"},null,-1),I=[D],w={key:3,width:"16",height:"16",viewBox:"0 0 24 24"},V=(0,a.Lk)("path",{d:"M14 20v-2h2.6l-3.2-3.2l1.425-1.425L18 16.55V14h2v6Zm-8.6 0L4 18.6L16.6 6H14V4h6v6h-2V7.4Zm3.775-9.425L4 5.4L5.4 4l5.175 5.175Z"},null,-1),S=[V],x={key:4,width:"16",height:"16",viewBox:"0 0 24 24"},E=(0,a.Lk)("path",{d:"M12 17q-2.075 0-3.537-1.463Q7 14.075 7 12t1.463-3.538Q9.925 7 12 7t3.538 1.462Q17 9.925 17 12q0 2.075-1.462 3.537Q14.075 17 12 17ZM2 13q-.425 0-.712-.288Q1 12.425 1 12t.288-.713Q1.575 11 2 11h2q.425 0 .713.287Q5 11.575 5 12t-.287.712Q4.425 13 4 13Zm18 0q-.425 0-.712-.288Q19 12.425 19 12t.288-.713Q19.575 11 20 11h2q.425 0 .712.287q.288.288.288.713t-.288.712Q22.425 13 22 13Zm-8-8q-.425 0-.712-.288Q11 4.425 11 4V2q0-.425.288-.713Q11.575 1 12 1t.713.287Q13 1.575 13 2v2q0 .425-.287.712Q12.425 5 12 5Zm0 18q-.425 0-.712-.288Q11 22.425 11 22v-2q0-.425.288-.712Q11.575 19 12 19t.713.288Q13 19.575 13 20v2q0 .425-.287.712Q12.425 23 12 23ZM5.65 7.05L4.575 6q-.3-.275-.288-.7q.013-.425.288-.725q.3-.3.725-.3t.7.3L7.05 5.65q.275.3.275.7q0 .4-.275.7q-.275.3-.687.287q-.413-.012-.713-.287ZM18 19.425l-1.05-1.075q-.275-.3-.275-.712q0-.413.275-.688q.275-.3.688-.287q.412.012.712.287L19.425 18q.3.275.288.7q-.013.425-.288.725q-.3.3-.725.3t-.7-.3ZM16.95 7.05q-.3-.275-.287-.688q.012-.412.287-.712L18 4.575q.275-.3.7-.288q.425.013.725.288q.3.3.3.725t-.3.7L18.35 7.05q-.3.275-.7.275q-.4 0-.7-.275ZM4.575 19.425q-.3-.3-.3-.725t.3-.7l1.075-1.05q.3-.275.713-.275q.412 0 .687.275q.3.275.288.688q-.013.412-.288.712L6 19.425q-.275.3-.7.287q-.425-.012-.725-.287Z"},null,-1),j=[E],T={key:5,width:"16",height:"16",viewBox:"0 0 24 24"},M=(0,a.Lk)("path",{d:"M12 21q-3.75 0-6.375-2.625T3 12q0-3.75 2.625-6.375T12 3q.35 0 .688.025q.337.025.662.075q-1.025.725-1.637 1.887Q11.1 6.15 11.1 7.5q0 2.25 1.575 3.825Q14.25 12.9 16.5 12.9q1.375 0 2.525-.613q1.15-.612 1.875-1.637q.05.325.075.662Q21 11.65 21 12q0 3.75-2.625 6.375T12 21Z"},null,-1),X=[M],U={key:6,width:"16",height:"16",viewBox:"0 0 24 24"},O=(0,a.Lk)("path",{d:"M20 19V7H4v12h16m0-16a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16m-7 14v-2h5v2h-5m-3.42-4L5.57 9H8.4l3.3 3.3c.39.39.39 1.03 0 1.42L8.42 17H5.59l3.99-4Z"},null,-1),R=[O];var A={__name:"ToolIcon",props:{name:{type:String,required:!0}},setup(e){return(o,t)=>((0,a.uX)(),(0,a.CE)(a.FK,null,["zoomin"===e.name?((0,a.uX)(),(0,a.CE)("svg",L,f)):(0,a.Q3)("",!0),"zoomout"===e.name?((0,a.uX)(),(0,a.CE)("svg",C,_)):(0,a.Q3)("",!0),"reset"===e.name?((0,a.uX)(),(0,a.CE)("svg",N,I)):(0,a.Q3)("",!0),"update"===e.name?((0,a.uX)(),(0,a.CE)("svg",w,S)):(0,a.Q3)("",!0),"sun"===e.name?((0,a.uX)(),(0,a.CE)("svg",x,j)):(0,a.Q3)("",!0),"moon"===e.name?((0,a.uX)(),(0,a.CE)("svg",T,X)):(0,a.Q3)("",!0),"log"===e.name?((0,a.uX)(),(0,a.CE)("svg",U,R)):(0,a.Q3)("",!0)],64))}};const B=A;var P=B;const Q={key:0,class:"NodeToolBox"},K=(0,a.Lk)("div",{class:"title"},"选择节点",-1),q={class:"items iconfont"},W=["onClick"],$={class:"Name"},J=(0,a.Lk)("div",{class:"Icon RBt icon-jinrujiantouxiao"},null,-1);function H(e,o,t,l,s,i){return t.isVisible?((0,a.uX)(),(0,a.CE)("div",Q,[K,(0,a.Lk)("div",q,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.NodeList.filter((e=>e.NodeClass==(1==t.nodeClass?"App":"Agent"))),((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o,onClick:o=>i.addNode(e.NodeType)},[(0,a.Lk)("div",{class:(0,n.C4)(["Icon",e.Icon])},null,2),(0,a.Lk)("div",$,(0,n.v_)(e.NodeName),1),J],8,W)))),128))])])])):(0,a.Q3)("",!0)}var z=t(8875),Z={name:"ToolBox",props:{node:Object,workflowID:String,mainID:String,isVisible:Boolean,nodeClass:Number},data(){return{NodeList:[{NodeName:"大模型",NodeType:"LargeModel",Icon:"icon-LargeModel",Description:"调用大语言模型，处理变量，配合提示词，生成输出",NodeClass:"Agent"},{NodeName:"知识库",NodeType:"KnowledgeBase",Icon:"icon-KnowledgeBase",Description:"根据输入的文本，调用知识库，获取知识库数据",NodeClass:"Agent"},{NodeName:"插件",NodeType:"Plugins",Icon:"icon-Plugins",Description:"插件可以提供更多能力，外部操作，获取外部数据等",NodeClass:"Agent"},{NodeName:"选择器",NodeType:"Selector",Icon:"icon-selector1",Description:"可以通过选择器的定义，链接多个下游执行节点",NodeClass:"Agent"},{NodeName:"Agent",NodeType:"Agent",Icon:"icon-Agent",Description:"调用Agent可以实现更多复杂组合",NodeClass:"App"},{NodeName:"时间触发器",NodeType:"TimeTrigger",Icon:"icon-TimeTrigger",Description:"可以定义一个特定时间点来触发下个节点",NodeClass:"App"}]}},methods:{addNode(e){m.addNode(e,this.workflowID,this.mainID).then((e=>{if(console.log(e),e.Status){var o=e.Data;this.$emit("addNode",o.Config)}else(0,z.me)({type:"warn",title:"Warn",text:e.ErrorDesc})}))}}},Y=t(1241);const G=(0,Y.A)(Z,[["render",H]]);var ee=G;const oe={class:"Title"},te={class:"LastUpdateTime"},le={class:"dialog-footer"};function ae(e,o,t,l,s,i){const d=(0,a.g2)("el-input"),u=(0,a.g2)("el-form-item"),c=(0,a.g2)("el-form"),r=(0,a.g2)("el-button"),p=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",{class:"WorkFlowInfo",onClick:o[0]||(o[0]=(...e)=>l.toggleDialog&&l.toggleDialog(...e))},[(0,a.Lk)("div",oe,(0,n.v_)(t.info.WorkflowName),1),(0,a.Lk)("div",te,(0,n.v_)(new Date(t.info.LastUpdateTime).toLocaleString()),1)]),(0,a.bF)(p,{modelValue:l.dialogFormVisible,"onUpdate:modelValue":o[3]||(o[3]=e=>l.dialogFormVisible=e),title:"工作流信息",width:"500"},{footer:(0,a.k6)((()=>[(0,a.Lk)("div",le,[(0,a.bF)(r,{onClick:l.closeDialog},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1},8,["onClick"]),(0,a.bF)(r,{type:"primary",onClick:i.save},{default:(0,a.k6)((()=>[(0,a.eW)("保存")])),_:1},8,["onClick"])])])),default:(0,a.k6)((()=>[(0,a.bF)(c,{model:e.form,"label-width":"auto"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{label:"工作流名称","label-position":"right"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{modelValue:l.Info.WorkflowName,"onUpdate:modelValue":o[1]||(o[1]=e=>l.Info.WorkflowName=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,a.bF)(u,{label:"说明","label-position":"right"},{default:(0,a.k6)((()=>[(0,a.bF)(d,{modelValue:l.Info.Description,"onUpdate:modelValue":o[2]||(o[2]=e=>l.Info.Description=e),"show-word-limit":"",maxlength:"128",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}var ne={name:"WorkFlowInfo",props:{node:Object,workflowID:String,isVisible:Boolean,info:Object},setup(e){const o=(0,i.KR)(!1),t=(0,i.KR)({});(0,a.sV)((()=>{t.value={...e.info}})),(0,a.wB)((()=>e.info),(e=>{t.value={...e}}),{immediate:!0});const l=()=>{o.value=!o.value},n=()=>{o.value=!1};return{dialogFormVisible:o,Info:t,toggleDialog:l,closeDialog:n}},methods:{show(){this.dialogFormVisible=!this.dialogFormVisible},save(){this.$emit("save",this.Info),this.dialogFormVisible=!1}}};const se=(0,Y.A)(ne,[["render",ae]]);var ie=se;const de={class:"WorkFlowData"},ue={class:"title"};function ce(e,o,t,l,s,i){return(0,a.uX)(),(0,a.CE)("div",de,[(0,a.Lk)("div",ue,(0,n.v_)(t.title),1)])}var re={name:"WorkFlowData",props:{title:String}};const pe=(0,Y.A)(re,[["render",ce]]);var he=pe,ke=t(8074);const me={class:"slider-input"},ge=["min","max"];function ve(e,o,t,s,i,d){return(0,a.uX)(),(0,a.CE)("div",me,[(0,a.bo)((0,a.Lk)("input",{type:"range",min:t.min,max:t.max,"onUpdate:modelValue":o[0]||(o[0]=e=>i.inputValue=e),onInput:o[1]||(o[1]=e=>d.updateValue(e.target.value)),onMousedown:o[2]||(o[2]=(0,l.D$)(((...e)=>s.handleRangeMouseDown&&s.handleRangeMouseDown(...e)),["stop"]))},null,40,ge),[[l.Jo,i.inputValue]]),(0,a.Lk)("span",null,(0,n.v_)(i.inputValue),1)])}var Fe={props:{modelValue:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100}},setup(){const e=()=>{};return{handleRangeMouseDown:e}},data(){return{inputValue:this.modelValue}},watch:{modelValue(e){this.inputValue=e}},methods:{updateValue(e){this.inputValue=e,this.$emit("update:modelValue",e)}}};const Le=(0,Y.A)(Fe,[["render",ve]]);var be=Le;const fe=e=>((0,a.Qi)("data-v-5f86e392"),e=e(),(0,a.jt)(),e),Ce={class:"InputVariables Content"},ye={class:"Title"},_e=fe((()=>(0,a.Lk)("span",null,"输入变量",-1))),Ne={key:0},De=fe((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"操作")],-1))),Ie=["onUpdate:modelValue","onChange"],we=fe((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Ve=["label"],Se=["value"],xe=["onUpdate:modelValue"],Ee=["onClick"];function je(e,o,t,s,i,d){const u=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)("div",Ce,[(0,a.Lk)("div",ye,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[i.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:o[0]||(o[0]=(...e)=>d.toggleFold&&d.toggleFold(...e))},null,2),_e]),i.isFold?((0,a.uX)(),(0,a.CE)("div",Ne,[(0,a.Lk)("table",null,[De,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.modelValue,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)(((0,a.uX)(),(0,a.CE)("select",{"onUpdate:modelValue":o=>e.sourceId=o,onChange:o=>d.onVarnameSelect(e,o.target.value),class:"VarnameSelect"},[we,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(d.groupVarnamesBySource(o),((e,o)=>((0,a.uX)(),(0,a.CE)("optgroup",{key:o,label:e.label||o},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.variables,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.sourceId,value:e.sourceId},(0,n.v_)(e.displayText),9,Se)))),128))],8,Ve)))),128))],40,Ie)),[[u],[l.u1,e.sourceId]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,xe),[[u],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.Lk)("span",{class:"DeleteBtn",onClick:e=>d.removeInput(o)},"×",8,Ee)])])))),128))])]),(0,a.Lk)("div",{class:"AddBtn",onClick:o[1]||(o[1]=(...e)=>d.addInput&&d.addInput(...e))},"+")])):(0,a.Q3)("",!0)])}var Te={name:"InputVariables",props:{modelValue:{type:Array,required:!0},sourceNodes:{type:Object,default:()=>({})}},emits:["update:modelValue","save"],data(){return{isFold:!0}},methods:{toggleFold(){this.isFold=!this.isFold},getAvailableVarnames(e){const o=[],t=this.modelValue.map(((o,t)=>t!==e?o.sourceId:null)).filter(Boolean);return this.sourceNodes&&Object.entries(this.sourceNodes).forEach((([e,l])=>{l.output&&l.output.forEach((a=>{const n=a.id;t.includes(n)||o.push({varname:a.varname,displayText:a.displayText,nodeId:e,label:l.label,sourceId:n})}))})),o.sort(((e,o)=>{const t=(e.label||e.nodeId).localeCompare(o.label||o.nodeId);return 0!==t?t:e.varname.localeCompare(o.varname)}))},groupVarnamesBySource(e){const o=this.getAvailableVarnames(e),t={};return o.forEach((e=>{const o=e.nodeId;t[o]||(t[o]={label:e.label,variables:[]}),t[o].variables.push({...e,displayText:e.displayText||`${e.varname} (${e.label})`,value:e.sourceId})})),t},onVarnameSelect(e,o){const t=this.getAvailableVarnames(this.modelValue.findIndex((o=>o===e))),l=t.find((e=>e.sourceId===o));l&&(e.varname=l.varname,e.sourceId=l.sourceId,e.type="string",e.txt=""),this.$emit("save")},addInput(){const e=[...this.modelValue,{varname:"",type:"string",txt:"",sourceId:""}];this.$emit("update:modelValue",e),this.$emit("save")},removeInput(e){const o=[...this.modelValue];o.splice(e,1),0===o.length&&o.push({varname:"",type:"string",txt:"",sourceId:""}),this.$emit("update:modelValue",o),this.$emit("save")}}};const Me=(0,Y.A)(Te,[["render",je],["__scopeId","data-v-5f86e392"]]);var Xe=Me;const Ue=e=>((0,a.Qi)("data-v-20d5ab1a"),e=e(),(0,a.jt)(),e),Oe={class:"Title"},Re=Ue((()=>(0,a.Lk)("span",{class:"Icon ticon icon-LargeModel"},null,-1))),Ae=Ue((()=>(0,a.Lk)("span",null,"大语言模型",-1))),Be={key:0,class:"Content"},Pe=Ue((()=>(0,a.Lk)("div",{class:"Description"},"调用大语言模型，处理变量，配合提示词，生成输出",-1))),Qe={class:"LargeModel Content"},Ke={class:"Title"},qe=Ue((()=>(0,a.Lk)("span",null,"模型",-1))),We={key:0},$e=["value"],Je={class:"Inputs Content"},He={class:"Title"},ze=Ue((()=>(0,a.Lk)("span",null,"提示词函数(插件)",-1))),Ze={key:0},Ye={class:"Plugins Content"},Ge={class:"Title"},eo=Ue((()=>(0,a.Lk)("span",null,"原生函数(插件)",-1))),oo={key:0},to={class:"Prompt Content"},lo={class:"Title"},ao=Ue((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),no={key:0},so=["placeholder"],io={class:"Coefficient Content"},uo={class:"Title"},co=Ue((()=>(0,a.Lk)("span",null,"系数设置",-1))),ro={key:0},po={class:"Outputs Content"},ho={class:"Title"},ko=Ue((()=>(0,a.Lk)("span",null,"输出变量",-1))),mo={key:0},go=["onUpdate:modelValue"],vo=["onUpdate:modelValue"],Fo=["onUpdate:modelValue"],Lo={name:"LargeModelNode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object,plugins:Object},components:{Multiselect:ke.Ay,SliderInput:be,InputVariables:Xe},data(){return{label:this.data.label,nodeData:{...this.data,model:this.data.model||{LargeModelID:0,Name:"",ModelName:"",ModelKey:"",MICON:"",TypeCode:0,TypeName:"",ModelOrganizationID:0,ModelOrganizationName:"",EndPoint:"",MConfig:"",Description:"",SystemStatus:0},inputs:this.data.inputs||[{varname:"input",value:"",type:"string",txt:""}],prompt:this.data.prompt||"",temperature:this.data.temperature||70,topp:this.data.topp||80,output:this.data.output||[{varname:"results",value:"",type:"string",txt:""}],SemanticFunction:this.data.SemanticFunction||[],NativeFunction:this.data.NativeFunction||[]},largeModelList:this.largeModel,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_plugins:!0,isFold_plugins2:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins},checkFoldPlugins2(){this.isFold_plugins2=!this.isFold_plugins2},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of t){const t=o[n];if(t.output&&t.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var bo=Object.assign(Lo,{setup(e){return(o,t)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form"),c=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox LargeModelNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Oe,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Re,Ae,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Be,[Pe,(0,a.Lk)("div",Qe,[(0,a.Lk)("div",Ke,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldLargeModel&&o.checkFoldLargeModel(...e))},null,2),qe]),o.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",We,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.largeModelList,((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,$e)))),128))],512),[[l.u1,o.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Je,[(0,a.Lk)("div",He,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[5]||(t[5]=(...e)=>o.checkFoldPlugins&&o.checkFoldPlugins(...e))},null,2),ze]),o.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Ze,[(0,a.bF)((0,i.R1)(ke.Ay),{modelValue:o.nodeData.SemanticFunction,"onUpdate:modelValue":t[6]||(t[6]=e=>o.nodeData.SemanticFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:o.pluginsList.filter((e=>1==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ye,[(0,a.Lk)("div",Ge,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_plugins2?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[7]||(t[7]=(...e)=>o.checkFoldPlugins2&&o.checkFoldPlugins2(...e))},null,2),eo]),o.isFold_plugins2?((0,a.uX)(),(0,a.CE)("div",oo,[(0,a.bF)((0,i.R1)(ke.Ay),{modelValue:o.nodeData.NativeFunction,"onUpdate:modelValue":t[8]||(t[8]=e=>o.nodeData.NativeFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:o.pluginsList.filter((e=>2==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[9]||(t[9]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",to,[(0,a.Lk)("div",lo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[10]||(t[10]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),ao]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",no,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[11]||(t[11]=e=>o.nodeData.prompt=e),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>{const[o,t]=e.sourceId.split("_");return"{{"+e.sourceId+"}}"})).join(",")]},null,8,so),[[l.Jo,o.nodeData.prompt],[c]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",io,[(0,a.Lk)("div",uo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[12]||(t[12]=(...e)=>o.checkCoefficient&&o.checkCoefficient(...e))},null,2),co]),o.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",ro,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.temperature,"onUpdate:modelValue":t[13]||(t[13]=e=>o.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.topp,"onUpdate:modelValue":t[14]||(t[14]=e=>o.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",po,[(0,a.Lk)("div",ho,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[15]||(t[15]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),ko]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",mo,[(0,a.Lk)("table",null,[(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:n},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.displayText=o,readonly:""},null,8,go),[[c],[l.Jo,e.displayText]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,vo),[[c],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o,onChange:t[16]||(t[16]=(...e)=>o.saveNode&&o.saveNode(...e))},null,40,Fo),[[c],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const fo=(0,Y.A)(bo,[["__scopeId","data-v-20d5ab1a"]]);var Co=fo;const yo=e=>((0,a.Qi)("data-v-5f1993ba"),e=e(),(0,a.jt)(),e),_o={class:"Title"},No=yo((()=>(0,a.Lk)("span",{class:"Icon ticon icon-Plugins"},null,-1))),Do=yo((()=>(0,a.Lk)("span",null,"插件",-1))),Io={key:0,class:"Content"},wo=yo((()=>(0,a.Lk)("div",{class:"Description"},"插件可以提供更多能力，外部操作，获取外部数据等",-1))),Vo={class:"Plugins Content"},So={class:"Title"},xo=yo((()=>(0,a.Lk)("span",null,"插件",-1))),Eo={key:0},jo=["value"],To={class:"Outputs Content"},Mo={class:"Title"},Xo=yo((()=>(0,a.Lk)("span",null,"输出",-1))),Uo={key:0},Oo=["onUpdate:modelValue"],Ro=["onUpdate:modelValue"],Ao=["onUpdate:modelValue"],Bo={name:"PluginsNode",props:{id:String,isSelected:Boolean,data:Object,plugins:Object},components:{InputVariables:Xe},data(){return{label:this.data.label,nodeData:this.data,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_plugins:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of t){const t=o[n];if(t.output&&t.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var Po=Object.assign(Bo,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox Plugins iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",_o,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),No,Do,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Io,[wo,(0,a.Lk)("div",Vo,[(0,a.Lk)("div",So,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldPlugins&&o.checkFoldPlugins(...e))},null,2),xo]),o.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Eo,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.plugins.PluginsID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.pluginsList.filter((e=>0==e.PluginsType)),((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.PluginsID},(0,n.v_)(e.Name),9,jo)))),128))],512),[[l.u1,o.nodeData.plugins.PluginsID]])])):(0,a.Q3)("",!0)]),(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[5]||(t[5]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",To,[(0,a.Lk)("div",Mo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),Xo]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",Uo,[(0,a.Lk)("table",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:n},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.displayText=o,readonly:""},null,8,Oo),[[s],[l.Jo,e.displayText]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,Ro),[[s],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o,onChange:t[7]||(t[7]=(...e)=>o.saveNode&&o.saveNode(...e))},null,40,Ao),[[s],[l.Jo,e.txt]])])])))),128))])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Qo=(0,Y.A)(Po,[["__scopeId","data-v-5f1993ba"]]);var Ko=Qo;const qo={class:"Title"},Wo=(0,a.Lk)("span",{class:"Icon ticon icon-start"},null,-1),$o=(0,a.Lk)("span",null,"开始",-1),Jo={key:0,class:"Content"},Ho=(0,a.Lk)("div",{class:"Description"},"工作流的起始节点，用于设定启动工作流需要的信息",-1),zo={class:"Inputs Content"},Zo={class:"Title"},Yo=(0,a.Lk)("span",null,"输入",-1),Go={key:0},et=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),ot=["onUpdate:modelValue"],tt=["onUpdate:modelValue"],lt={class:"Prompt Content"},at={class:"Title"},nt=(0,a.Lk)("span",null,"提示词",-1),st={key:0},it=["placeholder"],dt={class:"Outputs Content"},ut={class:"Title"},ct=(0,a.Lk)("span",null,"输出",-1),rt={key:0},pt=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述"),(0,a.Lk)("th")],-1),ht=["onUpdate:modelValue"],kt=["onUpdate:modelValue"],mt=["onUpdate:modelValue"],gt={name:"StartNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var vt=Object.assign(gt,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox StartNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",qo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Wo,$o]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Jo,[Ho,(0,a.Lk)("div",zo,[(0,a.Lk)("div",Zo,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[1]||(t[1]=(...e)=>o.checkFoldInputs&&o.checkFoldInputs(...e))},null,2),Yo]),o.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",Go,[(0,a.Lk)("table",null,[et,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.inputs,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o},null,8,ot),[[s],[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o},null,8,tt),[[s],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",lt,[(0,a.Lk)("div",at,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[2]||(t[2]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),nt]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",st,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.prompt=e),onMousedown:t[4]||(t[4]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[5]||(t[5]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+o.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,it),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",dt,[(0,a.Lk)("div",ut,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),ct]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",rt,[(0,a.Lk)("table",null,[pt,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o},null,8,ht),[[s],[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,kt),[[s],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o},null,8,mt),[[s],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Ft=vt;var Lt=Ft;const bt=e=>((0,a.Qi)("data-v-28998be0"),e=e(),(0,a.jt)(),e),ft={class:"Title"},Ct=bt((()=>(0,a.Lk)("span",{class:"Icon ticon icon-end"},null,-1))),yt=bt((()=>(0,a.Lk)("span",null,"结束",-1))),_t={key:0,class:"Content"},Nt=bt((()=>(0,a.Lk)("div",{class:"Description"},"工作流的结束节点，用于返回工作流运行后的结果信息",-1))),Dt={class:"Prompt Content"},It={class:"Title"},wt=bt((()=>(0,a.Lk)("span",null,"组织返回结果",-1))),Vt={key:0},St=["placeholder"],xt={name:"EndNode",props:{id:String,isSelected:Boolean,data:Object},components:{InputVariables:Xe},data(){return{label:this.data.label,nodeData:{...this.data,inputs:this.data.inputs||[{varname:"",type:"string",txt:"",sourceId:""}],prompt:this.data.prompt||""},isFold:!0,isFold_inputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((o,l)=>{if(o.sourceId){const[a]=o.sourceId.split("_");t.includes(a)&&e.push(l)}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:"",sourceId:""}),this.saveNode()}}},deep:!0}}};var Et=Object.assign(xt,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox EndNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",ft,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Ct,yt]),o.isFold?((0,a.uX)(),(0,a.CE)("div",_t,[Nt,(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[1]||(t[1]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",Dt,[(0,a.Lk)("div",It,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[2]||(t[2]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),wt]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Vt,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.prompt=e),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>{const[o,t]=e.sourceId.split("_");return"{{"+e.sourceId+"}}"})).join(",")]},null,8,St),[[l.Jo,o.nodeData.prompt],[s]])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const jt=(0,Y.A)(Et,[["__scopeId","data-v-28998be0"]]);var Tt=jt;const Mt=e=>((0,a.Qi)("data-v-5b639d74"),e=e(),(0,a.jt)(),e),Xt={class:"Title"},Ut=Mt((()=>(0,a.Lk)("span",{class:"Icon ticon icon-selector1"},null,-1))),Ot=Mt((()=>(0,a.Lk)("span",null,"选择器",-1))),Rt={key:0,class:"Content"},At=Mt((()=>(0,a.Lk)("div",{class:"Description"},"可以通过选择器的定义，链接多个下游执行节点",-1))),Bt={class:"Selector Content"},Pt={class:"Title"},Qt=Mt((()=>(0,a.Lk)("span",null,"条件判断",-1))),Kt={key:0},qt=Mt((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"判断条件"),(0,a.Lk)("th",null,"比较值"),(0,a.Lk)("th",null,"删除")],-1))),Wt=["onUpdate:modelValue"],$t=Mt((()=>(0,a.Lk)("option",{value:"",disabled:""},"请选择变量名",-1))),Jt=["label"],Ht=["value"],zt=["onUpdate:modelValue"],Zt=["value"],Yt=["onUpdate:modelValue"],Gt=["onClick"],el=Mt((()=>(0,a.Lk)("span",{class:"Icon ticon icon-add"},null,-1))),ol=Mt((()=>(0,a.Lk)("span",null,"增加条件",-1))),tl=[el,ol],ll={class:"Outputs Content"},al={class:"Title"},nl=Mt((()=>(0,a.Lk)("span",null,"输出",-1))),sl={key:0},il=Mt((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名")],-1))),dl=["onUpdate:modelValue"],ul={name:"SelectorNode",props:{id:String,isSelected:Boolean,data:Object},components:{InputVariables:Xe},created(){this.nodeData.output||(this.nodeData.output=[]),this.resetHandleTop(),this.syncOutputWithInputs()},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_selector:!0,isFold_outputs:!0,selectorList:this.data.selector?this.data.selector.map(((e,o)=>({id:e.id||F.guid(),inputs:e.inputs||"2",comparison:e.comparison||"",value:e.value||"",varname:e.varname||"",top:25*o+240,top_str:"top:"+(25*o+240)+"px"}))):[],comparison:[{name:"等于",data:"=",text:"等于"},{name:"不等于",data:"!=",text:"不等于"},{name:"大于",data:">",text:"大于"},{name:"小于",data:"<",text:"小于"},{name:"包含",data:"~=",text:"包含"},{name:"不包含",data:"!~=",text:"不包含"}]}},methods:{resetHandleTop(){var e=80;this.isFold?(e+=40,this.isFold_inputs&&(e+=40,e+=48*(this.nodeData.inputs?.length||0)),this.isFold_selector?(e+=80,this.selectorList=this.selectorList.map(((o,t)=>{const l=e+48*t;return{...o,top:l+24,top_str:"top:"+(l+24)+"px"}}))):(e+=40,this.selectorList=this.selectorList.map((o=>({...o,top:e,top_str:"top:"+e+"px"}))))):(e=25,this.selectorList=this.selectorList.map((o=>({...o,top:e,top_str:"top:"+e+"px"}))))},saveNode(){const e=this.selectorList.map((e=>({id:e.id,inputs:e.inputs,comparison:e.comparison,value:e.value,varname:e.varname})));this.syncOutputWithInputs(),this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label,selector:e,inputs:this.nodeData.inputs||[],output:this.nodeData.output}}),this.$nextTick((()=>{this.resetHandleTop()}))},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold,this.resetHandleTop()},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs,this.resetHandleTop()},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldSelector(){this.isFold_selector=!this.isFold_selector,this.resetHandleTop()},onAdd(){let e=80;if(this.isFold&&(e+=40,this.isFold_inputs&&(e+=40,e+=48*(this.nodeData.inputs?.length||0)),this.isFold_selector)){e+=80;const o=e+48*this.selectorList.length,t={id:F.guid(),inputs:"2",comparison:"",value:"",varname:"",top:o+24,top_str:"top:"+(o+24)+"px"};this.selectorList.push(t),this.saveNode()}},onDel(e){this.selectorList=this.selectorList.filter((o=>o.id!==e.id)),this.saveNode()},groupVarnamesBySource(){const e={};if(this.data.sourceNodes)for(const o of Object.values(this.data.sourceNodes))o.output&&(e[o.nodeId]={label:o.label,variables:o.output.map((e=>({varname:e.varname,sourceId:o.nodeId,displayText:`${e.varname} (${o.label})`})))});return e},syncOutputWithInputs(){if(!this.nodeData.inputs)return void(this.nodeData.output=[]);const e=this.nodeData.inputs.map((e=>{const o=e.sourceId?.split("_")[0],t=o?this.data.sourceNodes[o]:null,l=t?t.label:"Unknown",a=t?.output?.find((o=>o.id===e.sourceId));return{varname:e.varname,displayText:`${e.varname} (${l})`,type:e.type||"string",txt:e.txt||"",sourceId:a?.id||e.sourceId,nodeId:o}}));this.nodeData.output.length=0,this.nodeData.output.push(...e)}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of t){const t=o[n];if(t.output&&t.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0},"nodeData.inputs":{handler(){this.syncOutputWithInputs()},deep:!0}}};var cl=Object.assign(ul,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{id:"target_1",class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.selectorList,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id},[(0,a.bF)((0,i.R1)(d.h7),{id:e.id,class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:(0,n.Tr)(e.top_str)},null,8,["id","position","style"])])))),128)),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox SelectorNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Xt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Ut,Ot,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Rt,[At,(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",Bt,[(0,a.Lk)("div",Pt,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_selector?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[4]||(t[4]=(...e)=>o.checkFoldSelector&&o.checkFoldSelector(...e))},null,2),Qt]),o.isFold_selector?((0,a.uX)(),(0,a.CE)("div",Kt,[(0,a.Lk)("table",null,[qt,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.selectorList,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o=>e.varname=o,class:"VarnameSelect"},[$t,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.groupVarnamesBySource(),((e,o)=>((0,a.uX)(),(0,a.CE)("optgroup",{key:o,label:e.label||o},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.variables,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.sourceId,value:e.varname},(0,n.v_)(e.displayText),9,Ht)))),128))],8,Jt)))),128))],8,Wt),[[l.u1,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o=>e.comparison=o},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.comparison,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.name,value:e.data},(0,n.v_)(e.text),9,Zt)))),128))],8,zt),[[l.u1,e.comparison]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{placeholder:"留空代表字符串空","onUpdate:modelValue":o=>e.value=o},null,8,Yt),[[l.Jo,e.value]])]),(0,a.Lk)("td",null,[(0,a.Lk)("span",{class:"Icon ticon icon-del del",onClick:t=>o.onDel(e)},null,8,Gt)])])))),128))]),(0,a.Lk)("footer",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("td",{colspan:"4",class:"add",onClick:t[5]||(t[5]=(...e)=>o.onAdd&&o.onAdd(...e))},tl)])])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ll,[(0,a.Lk)("div",al,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),nl]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",sl,[(0,a.Lk)("table",null,[il,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.displayText=o,readonly:""},null,8,dl),[[s],[l.Jo,e.displayText]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const rl=(0,Y.A)(cl,[["__scopeId","data-v-5b639d74"]]);var pl=rl;const hl=e=>((0,a.Qi)("data-v-565017ac"),e=e(),(0,a.jt)(),e),kl={class:"Title"},ml=hl((()=>(0,a.Lk)("span",{class:"Icon ticon icon-KnowledgeBase"},null,-1))),gl=hl((()=>(0,a.Lk)("span",null,"知识库",-1))),vl={key:0,class:"Content"},Fl=hl((()=>(0,a.Lk)("div",{class:"Description"},"根据输入的文本，调用知识库，获取知识库数据",-1))),Ll={class:"KnowledgeBase Content"},bl={class:"Title"},fl=hl((()=>(0,a.Lk)("span",null,"知识库",-1))),Cl={key:0},yl={class:"LargeModel Content"},_l={class:"Title"},Nl=hl((()=>(0,a.Lk)("span",null,"模型",-1))),Dl={key:0},Il=["value"],wl={class:"Prompt Content"},Vl={class:"Title"},Sl=hl((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),xl={key:0},El=["placeholder"],jl={class:"Coefficient Content"},Tl={class:"Title"},Ml=hl((()=>(0,a.Lk)("span",null,"系数设置",-1))),Xl={key:0},Ul={class:"Outputs Content"},Ol={class:"Title"},Rl=hl((()=>(0,a.Lk)("span",null,"输出",-1))),Al={key:0},Bl=["onUpdate:modelValue"],Pl={name:"KnowledgeBaseNode",props:{id:String,isSelected:Boolean,data:Object,knowledgeBase:Object,largeModel:Object},components:{Multiselect:ke.Ay,SliderInput:be,InputVariables:Xe},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,KnowledgeBaseList:this.knowledgeBase,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_KnowledgeBase:!0,isFold_Coefficient:!0}},methods:{saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkFoldKnowledgeBase(){console.log(this.KnowledgeBaseList),this.isFold_KnowledgeBase=!this.isFold_KnowledgeBase},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of t){const t=o[n];if(t.output&&t.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var Ql=Object.assign(Pl,{setup(e){return(o,t)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form"),c=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox KnowledgeBaseNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",kl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),ml,gl,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",vl,[Fl,(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",Ll,[(0,a.Lk)("div",bl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_KnowledgeBase?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[4]||(t[4]=(...e)=>o.checkFoldKnowledgeBase&&o.checkFoldKnowledgeBase(...e))},null,2),fl]),o.isFold_KnowledgeBase?((0,a.uX)(),(0,a.CE)("div",Cl,[(0,a.bF)((0,i.R1)(ke.Ay),{modelValue:o.nodeData.knowledgeBase,"onUpdate:modelValue":t[5]||(t[5]=e=>o.nodeData.knowledgeBase=e),placeholder:"请选择知识库",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:o.KnowledgeBaseList},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",yl,[(0,a.Lk)("div",_l,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldLargeModel&&o.checkFoldLargeModel(...e))},null,2),Nl]),o.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",Dl,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.largeModelList,((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,Il)))),128))],512),[[l.u1,o.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",wl,[(0,a.Lk)("div",Vl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[8]||(t[8]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),Sl]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",xl,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.nodeData.prompt=e),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>{const[o,t]=e.sourceId.split("_");return"{{"+e.sourceId+"}}"})).join(",")]},null,8,El),[[l.Jo,o.nodeData.prompt],[c]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",jl,[(0,a.Lk)("div",Tl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[10]||(t[10]=(...e)=>o.checkCoefficient&&o.checkCoefficient(...e))},null,2),Ml]),o.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",Xl,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.temperature,"onUpdate:modelValue":t[11]||(t[11]=e=>o.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.topp,"onUpdate:modelValue":t[12]||(t[12]=e=>o.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ul,[(0,a.Lk)("div",Ol,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[13]||(t[13]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),Rl]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",Al,[(0,a.Lk)("table",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:s},[(0,a.Lk)("td",null,(0,n.v_)(e.displayText),1),(0,a.Lk)("td",null,(0,n.v_)(e.type),1),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o,onChange:t[14]||(t[14]=(...e)=>o.saveNode&&o.saveNode(...e))},null,40,Bl),[[c],[l.Jo,e.txt]])])])))),128))])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Kl=(0,Y.A)(Ql,[["__scopeId","data-v-565017ac"]]);var ql=Kl;const Wl={class:"Title"},$l=(0,a.Lk)("span",{class:"Icon ticon icon-start"},null,-1),Jl=(0,a.Lk)("span",null,"开始",-1),Hl={key:0,class:"Content"},zl=(0,a.Lk)("div",{class:"Description"},"工作流的起始节点，用于设定启动工作流需要的信息",-1),Zl={class:"Inputs Content"},Yl={class:"Title"},Gl=(0,a.Lk)("span",null,"输入",-1),ea={key:0},oa=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),ta=["onUpdate:modelValue"],la=["onUpdate:modelValue"],aa={class:"Prompt Content"},na={class:"Title"},sa=(0,a.Lk)("span",null,"提示词",-1),ia={key:0},da=["placeholder"],ua={class:"Outputs Content"},ca={class:"Title"},ra=(0,a.Lk)("span",null,"输出",-1),pa={key:0},ha=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"显示文本"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述")],-1),ka=["onUpdate:modelValue"],ma=["onUpdate:modelValue"],ga=["onUpdate:modelValue"],va={name:"StartNode",props:{id:String,isSelected:Boolean,data:Object},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var Fa=Object.assign(va,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox StartNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Wl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),$l,Jl]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Hl,[zl,(0,a.Lk)("div",Zl,[(0,a.Lk)("div",Yl,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_inputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[1]||(t[1]=(...e)=>o.checkFoldInputs&&o.checkFoldInputs(...e))},null,2),Gl]),o.isFold_inputs?((0,a.uX)(),(0,a.CE)("div",ea,[(0,a.Lk)("table",null,[oa,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.inputs,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o},null,8,ta),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o},null,8,la),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",aa,[(0,a.Lk)("div",na,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[2]||(t[2]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),sa]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",ia,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.prompt=e),onMousedown:t[4]||(t[4]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[5]||(t[5]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+o.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,da),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ua,[(0,a.Lk)("div",ca,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),ra]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",pa,[(0,a.Lk)("table",null,[ha,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:n},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.displayText=o,readonly:""},null,8,ka),[[s],[l.Jo,e.displayText]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,ma),[[s],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o,onChange:t[7]||(t[7]=(...e)=>o.saveNode&&o.saveNode(...e))},null,40,ga),[[s],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const La=Fa;var ba=La;const fa=e=>((0,a.Qi)("data-v-5198160c"),e=e(),(0,a.jt)(),e),Ca={class:"Title"},ya=fa((()=>(0,a.Lk)("span",{class:"Icon ticon icon-end"},null,-1))),_a=fa((()=>(0,a.Lk)("span",null,"结束",-1))),Na={key:0,class:"Content"},Da=fa((()=>(0,a.Lk)("div",{class:"Description"},"工作流的结束节点，用于返回工作流运行后的结果信息",-1))),Ia={class:"Prompt Content"},wa={class:"Title"},Va=fa((()=>(0,a.Lk)("span",null,"组织返回结果",-1))),Sa={key:0},xa=["placeholder"],Ea={name:"AgentEndNode",props:{id:String,isSelected:Boolean,data:Object},components:{InputVariables:Xe},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_inputs:!0,isFold_prompt:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((l,a)=>{for(const n of t){const t=o[n];if(t.output&&t.output.some((e=>e.varname===l.varname))){e.push(a);break}}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:""}),this.saveNode()}}},deep:!0}}};var ja=Object.assign(Ea,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox EndNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Ca,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),ya,_a]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Na,[Da,(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[1]||(t[1]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",Ia,[(0,a.Lk)("div",wa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[2]||(t[2]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),Va]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Sa,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.nodeData.prompt=e),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>{const[o,t]=e.sourceId.split("_");return"{{"+e.sourceId+"}}"})).join(",")]},null,8,xa),[[l.Jo,o.nodeData.prompt],[s]])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Ta=(0,Y.A)(ja,[["__scopeId","data-v-5198160c"]]);var Ma=Ta;const Xa={class:"Title"},Ua=(0,a.Lk)("span",{class:"Icon ticon icon-TimeTrigger"},null,-1),Oa=(0,a.Lk)("span",null,"时间触发器",-1),Ra={key:0,class:"Content"},Aa=(0,a.Lk)("div",{class:"Description"},"可以定义一个特定时间点来触发下个节点",-1),Ba={class:"TimeTrigger Content"},Pa={class:"Title"},Qa=(0,a.Lk)("span",null,"触发周期",-1),Ka={key:0},qa={class:"Prompt Content"},Wa={class:"Title"},$a=(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，作为下个节点的输入参数）",-1),Ja={key:0},Ha={class:"Outputs Content"},za={class:"Title"},Za=(0,a.Lk)("span",null,"输出",-1),Ya={key:0},Ga=(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1),en=["onUpdate:modelValue"],on=["onUpdate:modelValue"],tn={name:"TimeTriggerNode",props:{id:String,isSelected:Boolean,data:Object},created(){},data(){return{label:this.data.label,nodeData:this.data,isFold:!0,isFold_outputs:!0,isFold_TimeTrigger:!0,isFold_prompt:!0,loopType:[{name:"每隔n秒",data:"s",text:"每n秒"},{name:"每隔n天",data:"d",text:"每n天"},{name:"每周星期几",data:"w",text:"每周星期几"},{name:"每月第几日",data:"m",text:"每月第几日"}]}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold,this.resetHandleTop()},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldTimeTrigger(){this.isFold_TimeTrigger=!this.isFold_TimeTrigger,this.resetHandleTop()},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}}};var ln=Object.assign(tn,{setup(e){return(o,t)=>{const s=(0,a.g2)("el-option"),u=(0,a.g2)("el-select"),c=(0,a.g2)("el-form-item"),r=(0,a.g2)("el-input"),p=(0,a.g2)("el-date-picker"),h=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox TimeTriggerNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Xa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Ua,Oa,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Ra,[Aa,(0,a.Lk)("div",Ba,[(0,a.Lk)("div",Pa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_TimeTrigger?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldTimeTrigger&&o.checkFoldTimeTrigger(...e))},null,2),Qa]),o.isFold_TimeTrigger?((0,a.uX)(),(0,a.CE)("div",Ka,[(0,a.bF)(h,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(c,{label:"循环类型"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{modelValue:o.nodeData.timeTrigger.loopType,"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.timeTrigger.loopType=e),placeholder:"循环类型"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.loopType,(e=>((0,a.uX)(),(0,a.Wv)(s,{key:e.name,value:e.data,label:e.text},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(c,{label:"周期"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.nodeData.timeTrigger.IntervalValue,"onUpdate:modelValue":t[5]||(t[5]=e=>o.nodeData.timeTrigger.IntervalValue=e),type:"number",placeholder:"循环类型N的值"},null,8,["modelValue"])])),_:1}),(0,a.bF)(c,{label:"第一次开始时间",title:"循环类型为日、周、月时该值的时间'hh:mm'为每次循环的开始时间"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{modelValue:o.nodeData.timeTrigger.StartTime,"onUpdate:modelValue":t[6]||(t[6]=e=>o.nodeData.timeTrigger.StartTime=e),type:"datetime",placeholder:"选择","default-time":o.defaultTime},null,8,["modelValue","default-time"])])),_:1}),(0,a.bF)(c,{label:"执行次数"},{default:(0,a.k6)((()=>[(0,a.bF)(r,{modelValue:o.nodeData.timeTrigger.RepeatValue,"onUpdate:modelValue":t[7]||(t[7]=e=>o.nodeData.timeTrigger.RepeatValue=e),type:"number",placeholder:"0等于无限次"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",qa,[(0,a.Lk)("div",Wa,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[8]||(t[8]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),$a]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Ja,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.nodeData.prompt=e),onMousedown:t[10]||(t[10]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[11]||(t[11]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词：{{currentTime}}"]},null,544),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ha,[(0,a.Lk)("div",za,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[12]||(t[12]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),Za]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",Ya,[(0,a.Lk)("table",null,[Ga,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o},null,8,en),[[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o},null,8,on),[[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const an=ln;var nn=an;const sn=e=>((0,a.Qi)("data-v-c1d0a43a"),e=e(),(0,a.jt)(),e),dn={class:"Title"},un=sn((()=>(0,a.Lk)("span",{class:"Icon ticon icon-Agent"},null,-1))),cn=sn((()=>(0,a.Lk)("span",null,"Agent",-1))),rn={key:0,class:"Content"},pn=sn((()=>(0,a.Lk)("div",{class:"Description"},"调用Agent可以实现更多复杂组合",-1))),hn={class:"Agent Content"},kn={class:"Title"},mn=sn((()=>(0,a.Lk)("span",null,"Agent",-1))),gn={key:0},vn=["value"],Fn={class:"Prompt Content"},Ln={class:"Title"},bn=sn((()=>(0,a.Lk)("span",null,"Agent说明(让主控AI更好的理解Agent的作用，并合理安排触发任务)",-1))),fn={key:0},Cn=["placeholder"],yn={class:"Outputs Content"},_n={class:"Title"},Nn=sn((()=>(0,a.Lk)("span",null,"输出",-1))),Dn={key:0},In=sn((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"描述")],-1))),wn=["onUpdate:modelValue"],Vn=["onUpdate:modelValue"],Sn=["onUpdate:modelValue"],xn={name:"AgentNode",props:{id:String,isSelected:Boolean,data:Object,agents:Object},data(){return{label:this.data.label,nodeData:this.data,agentList:this.agents,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_Agent:!0,isFold_prompt:!0}},components:{Handle:d.h7,InputVariables:Xe},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldAgent(){this.isFold_Agent=!this.isFold_Agent},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((o,l)=>{if(o.sourceId){const[a]=o.sourceId.split("_");t.includes(a)&&e.push(l)}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:"",sourceId:""}),this.saveNode()}}},deep:!0}}};var En=Object.assign(xn,{setup(e){return(o,t)=>{const s=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox Agent iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",dn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),un,cn,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",rn,[pn,(0,a.Lk)("div",hn,[(0,a.Lk)("div",kn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_Agent?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldAgent&&o.checkFoldAgent(...e))},null,2),mn]),o.isFold_Agent?((0,a.uX)(),(0,a.CE)("div",gn,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.agent.AgentID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.agentList,((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.AgentID},(0,n.v_)(e.Name),9,vn)))),128))],512),[[l.u1,o.nodeData.agent.AgentID]])])):(0,a.Q3)("",!0)]),(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[5]||(t[5]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",Fn,[(0,a.Lk)("div",Ln,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[6]||(t[6]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),bn]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",fn,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>o.nodeData.prompt=e),onMousedown:t[8]||(t[8]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[9]||(t[9]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>"{{"+e.sourceId+"}}")).join(",")]},null,40,Cn),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",yn,[(0,a.Lk)("div",_n,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[10]||(t[10]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),Nn]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",Dn,[(0,a.Lk)("table",null,[In,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:n},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o,readonly:""},null,8,wn),[[s],[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.type=o,readonly:""},null,8,Vn),[[s],[l.Jo,e.type]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o,onChange:t[11]||(t[11]=(...e)=>o.saveNode&&o.saveNode(...e))},null,40,Sn),[[s],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const jn=(0,Y.A)(En,[["__scopeId","data-v-c1d0a43a"]]);var Tn=jn;const Mn=e=>((0,a.Qi)("data-v-2baccb98"),e=e(),(0,a.jt)(),e),Xn={class:"Title"},Un=Mn((()=>(0,a.Lk)("span",{class:"Icon ticon icon-MainAI"},null,-1))),On=Mn((()=>(0,a.Lk)("span",null,"主控AI",-1))),Rn={key:0,class:"Content"},An=Mn((()=>(0,a.Lk)("div",{class:"Description"},"主导应用的核心AI，可以调用多个Agent",-1))),Bn={class:"LargeModel Content"},Pn={class:"Title"},Qn=Mn((()=>(0,a.Lk)("span",null,"模型",-1))),Kn={key:0},qn=["value"],Wn={class:"Inputs Content"},$n={class:"Title"},Jn=Mn((()=>(0,a.Lk)("span",null,"提示词函数(插件)",-1))),Hn={key:0},zn={class:"Plugins Content"},Zn={class:"Title"},Yn=Mn((()=>(0,a.Lk)("span",null,"原生函数(插件)",-1))),Gn={key:0},es={class:"Prompt Content"},os={class:"Title"},ts=Mn((()=>(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1))),ls={key:0},as=["placeholder"],ns={class:"Coefficient Content"},ss={class:"Title"},is=Mn((()=>(0,a.Lk)("span",null,"系数设置",-1))),ds={key:0},us={class:"Outputs Content"},cs={class:"Title"},rs=Mn((()=>(0,a.Lk)("span",null,"输出",-1))),ps={key:0},hs=Mn((()=>(0,a.Lk)("thead",null,[(0,a.Lk)("th",null,"变量名"),(0,a.Lk)("th",null,"描述")],-1))),ks=["onUpdate:modelValue"],ms=["onUpdate:modelValue"],gs={name:"MainAINode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object,plugins:Object},components:{Multiselect:ke.Ay,SliderInput:be,InputVariables:Xe},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,pluginsList:this.plugins,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_mainAI:!0,isFold_plugins:!0,isFold_plugins2:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldMainAI(){this.isFold_mainAI=!this.isFold_mainAI},checkFoldPlugins(){this.isFold_plugins=!this.isFold_plugins},checkFoldPlugins2(){this.isFold_plugins2=!this.isFold_plugins2},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient}},watch:{"data.sourceNodes":{handler(e,o){if(o){const t=Object.keys(o).filter((o=>!e||!e[o]));if(t.length>0){const e=[];this.nodeData.inputs.forEach(((o,l)=>{if(o.sourceId){const[a]=o.sourceId.split("_");t.includes(a)&&e.push(l)}}));for(let o=e.length-1;o>=0;o--)this.nodeData.inputs.splice(e[o],1);0===this.nodeData.inputs.length&&this.nodeData.inputs.push({varname:"",type:"string",txt:"",sourceId:""}),this.saveNode()}}},deep:!0}}};var vs=Object.assign(gs,{setup(e){return(o,t)=>{const s=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form"),c=(0,a.gN)("stop-propagation");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"target",position:(0,i.R1)(d.yX).Left,style:{}},null,8,["position"]),(0,a.bF)((0,i.R1)(d.h7),{class:"Handle",type:"source",position:(0,i.R1)(d.yX).Right,style:{}},null,8,["position"]),(0,a.Lk)("div",{class:(0,n.C4)(["NodeBox MainAINode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",Xn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Un,On,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",Rn,[An,(0,a.Lk)("div",Bn,[(0,a.Lk)("div",Pn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_mainAI?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldMainAI&&o.checkFoldMainAI(...e))},null,2),Qn]),o.isFold_mainAI?((0,a.uX)(),(0,a.CE)("div",Kn,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.largeModelList,((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,qn)))),128))],512),[[l.u1,o.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Wn,[(0,a.Lk)("div",$n,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_plugins?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[5]||(t[5]=(...e)=>o.checkFoldPlugins&&o.checkFoldPlugins(...e))},null,2),Jn]),o.isFold_plugins?((0,a.uX)(),(0,a.CE)("div",Hn,[(0,a.bF)((0,i.R1)(ke.Ay),{modelValue:o.nodeData.SemanticFunction,"onUpdate:modelValue":t[6]||(t[6]=e=>o.nodeData.SemanticFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:o.pluginsList.filter((e=>1==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",zn,[(0,a.Lk)("div",Zn,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_plugins2?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[7]||(t[7]=(...e)=>o.checkFoldPlugins2&&o.checkFoldPlugins2(...e))},null,2),Yn]),o.isFold_plugins2?((0,a.uX)(),(0,a.CE)("div",Gn,[(0,a.bF)((0,i.R1)(ke.Ay),{modelValue:o.nodeData.NativeFunction,"onUpdate:modelValue":t[8]||(t[8]=e=>o.nodeData.NativeFunction=e),placeholder:"请选择函数",multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,label:"Name","track-by":"Name",taggable:"true",options:o.pluginsList.filter((e=>2==e.PluginsType))},null,8,["modelValue","options"])])):(0,a.Q3)("",!0)]),(0,a.bF)(Xe,{modelValue:o.nodeData.inputs,"onUpdate:modelValue":t[9]||(t[9]=e=>o.nodeData.inputs=e),sourceNodes:e.data.sourceNodes,onSave:o.saveNode},null,8,["modelValue","sourceNodes","onSave"]),(0,a.Lk)("div",es,[(0,a.Lk)("div",os,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[10]||(t[10]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),ts]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",ls,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[11]||(t[11]=e=>o.nodeData.prompt=e),onMousedown:t[12]||(t[12]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[13]||(t[13]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["需要将变量拼接在待返回的字符串中："+o.nodeData.inputs.filter((e=>e.sourceId&&e.varname)).map((e=>"{{"+e.sourceId+"}}")).join(",")]},null,40,as),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ns,[(0,a.Lk)("div",ss,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[14]||(t[14]=(...e)=>o.checkCoefficient&&o.checkCoefficient(...e))},null,2),is]),o.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",ds,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.temperature,"onUpdate:modelValue":t[15]||(t[15]=e=>o.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.topp,"onUpdate:modelValue":t[16]||(t[16]=e=>o.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",us,[(0,a.Lk)("div",cs,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_outputs?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[17]||(t[17]=(...e)=>o.checkFoldOutputs&&o.checkFoldOutputs(...e))},null,2),rs]),o.isFold_outputs?((0,a.uX)(),(0,a.CE)("div",ps,[(0,a.Lk)("table",null,[hs,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.nodeData.output,((e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.varname=o},null,8,ks),[[c],[l.Jo,e.varname]])]),(0,a.Lk)("td",null,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":o=>e.txt=o},null,8,ms),[[c],[l.Jo,e.txt]])])])))),128))])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)],64)}}});const Fs=(0,Y.A)(vs,[["__scopeId","data-v-2baccb98"]]);var Ls=Fs,bs=t(7477);const fs={class:"Title"},Cs=(0,a.Lk)("span",{class:"Icon ticon icon-Reporter"},null,-1),ys=(0,a.Lk)("span",null,"记录员",-1),_s={key:0,class:"Content"},Ns=(0,a.Lk)("div",{class:"Description"}," 调用大语言模型，记录会话内容，并进行必要的摘要与整理，减少回话上下文长度，提高会话质量 ",-1),Ds={class:"LargeModel Content"},Is={class:"Title"},ws=(0,a.Lk)("span",null,"模型",-1),Vs={key:0},Ss=["value"],xs={class:"Prompt Content"},Es={class:"Title"},js=(0,a.Lk)("span",null,"提示词（将输入变量与提示词整理，并让AI重新生成返回结果）",-1),Ts={key:0},Ms=["placeholder"],Xs={class:"Coefficient Content"},Us={class:"Title"},Os=(0,a.Lk)("span",null,"系数设置",-1),Rs={key:0},As={name:"ReporterNode",props:{id:String,isSelected:Boolean,data:Object,largeModel:Object},components:{SliderInput:be},data(){return{label:this.data.label,nodeData:this.data,largeModelList:this.largeModel,isFold:!0,isFold_inputs:!0,isFold_outputs:!0,isFold_prompt:!0,isFold_largemodel:!0,isFold_Coefficient:!0}},methods:{handleRangeMouseDown(){},saveNode(){this.$emit("saveNode",{id:this.id,data:{...this.nodeData,label:this.label}})},saveLabel(){this.saveNode()},checkFold(){this.isFold=!this.isFold},checkFoldInputs(){this.isFold_inputs=!this.isFold_inputs},checkFoldOutputs(){this.isFold_outputs=!this.isFold_outputs},checkFoldPrompt(){this.isFold_prompt=!this.isFold_prompt},checkFoldLargeModel(){this.isFold_largemodel=!this.isFold_largemodel},checkCoefficient(){this.isFold_Coefficient=!this.isFold_Coefficient}}};var Bs=Object.assign(As,{setup(e){return(o,t)=>{const s=(0,a.g2)("el-switch"),d=(0,a.g2)("el-form-item"),u=(0,a.g2)("el-form");return(0,a.uX)(),(0,a.CE)("div",{class:(0,n.C4)(["NodeBox ReporterNode iconfont",[e.isSelected?"Selected":"",""]])},[(0,a.Lk)("div",fs,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[0]||(t[0]=(...e)=>o.checkFold&&o.checkFold(...e))},null,2),Cs,ys,(0,a.bo)((0,a.Lk)("input",{class:"label","onUpdate:modelValue":t[1]||(t[1]=e=>o.label=e),value:"{{label}}",placeholder:"备注",onBlur:t[2]||(t[2]=(...e)=>o.saveLabel&&o.saveLabel(...e))},null,544),[[l.Jo,o.label]])]),o.isFold?((0,a.uX)(),(0,a.CE)("div",_s,[Ns,(0,a.Lk)("div",Ds,[(0,a.Lk)("div",Is,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_largemodel?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[3]||(t[3]=(...e)=>o.checkFoldLargeModel&&o.checkFoldLargeModel(...e))},null,2),ws]),o.isFold_largemodel?((0,a.uX)(),(0,a.CE)("div",Vs,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>o.nodeData.model.LargeModelID=e)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.largeModelList,((e,o)=>((0,a.uX)(),(0,a.CE)("option",{key:o,value:e.LargeModelID},(0,n.v_)(e.ModelOrganizationName)+"("+(0,n.v_)(e.Name)+") ",9,Ss)))),128))],512),[[l.u1,o.nodeData.model.LargeModelID]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",xs,[(0,a.Lk)("div",Es,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_prompt?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[5]||(t[5]=(...e)=>o.checkFoldPrompt&&o.checkFoldPrompt(...e))},null,2),js]),o.isFold_prompt?((0,a.uX)(),(0,a.CE)("div",Ts,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>o.nodeData.prompt=e),onMousedown:t[7]||(t[7]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),onWheel:t[8]||(t[8]=(0,l.D$)(((...e)=>o.handleRangeMouseDown&&o.handleRangeMouseDown(...e)),["stop"])),placeholder:["请输入提示词："+o.nodeData.inputs.map((e=>"{{"+e.varname+"}}")).join(",")]},null,40,Ms),[[l.Jo,o.nodeData.prompt]])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Xs,[(0,a.Lk)("div",Us,[(0,a.Lk)("span",{class:(0,n.C4)(["Icon fold",[o.isFold_Coefficient?"icon-jiantou-d":"icon-jiantou-r"]]),onClick:t[9]||(t[9]=(...e)=>o.checkCoefficient&&o.checkCoefficient(...e))},null,2),Os]),o.isFold_Coefficient?((0,a.uX)(),(0,a.CE)("div",Rs,[(0,a.bF)(u,{"label-width":"auto",style:{"max-width":"600px"},"status-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(d,{label:"是否启用"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{modelValue:o.nodeData.enable,"onUpdate:modelValue":t[10]||(t[10]=e=>o.nodeData.enable=e),class:"mt-2",style:{"margin-left":"10px"},"inline-prompt":"","active-icon":(0,i.R1)(bs.Jlk),"inactive-icon":(0,i.R1)(bs.bm)},null,8,["modelValue","active-icon","inactive-icon"])])),_:1}),(0,a.bF)(d,{label:"随机性(值越大越有创造力)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.temperature,"onUpdate:modelValue":t[11]||(t[11]=e=>o.nodeData.temperature=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(d,{label:"多样性(值越大越有多样性)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.topp,"onUpdate:modelValue":t[12]||(t[12]=e=>o.nodeData.topp=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1}),(0,a.bF)(d,{label:"每次总结记录数(会话条数)"},{default:(0,a.k6)((()=>[(0,a.bF)(be,{modelValue:o.nodeData.recordslength,"onUpdate:modelValue":t[13]||(t[13]=e=>o.nodeData.recordslength=e),min:"0",max:"100"},null,8,["modelValue"])])),_:1})])),_:1})])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],2)}}});const Ps=Bs;var Qs=Ps;const Ks=["cx","cy"],qs=["d"],Ws=["transform","d"],$s={inheritAttrs:!1};var Js=Object.assign($s,{__name:"CustomEdge",props:{id:{type:String,required:!0},sourceX:{type:Number,required:!0},sourceY:{type:Number,required:!0},targetX:{type:Number,required:!0},targetY:{type:Number,required:!0},sourcePosition:{type:String,required:!0},targetPosition:{type:String,required:!0},data:{type:Object,required:!1},markerEnd:{type:String,required:!1},style:{type:Object,required:!1}},setup(e){const o=e,t=(0,a.EW)((()=>(0,d.Fp)(o)));return(l,s)=>((0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)((0,i.R1)(d.tE),{id:e.id,style:(0,n.Tr)(e.style),path:t.value[0],"marker-end":e.markerEnd,label:e.data.text,"label-x":t.value[1],"label-y":t.value[2],"label-style":{fill:"white"},"label-show-bg":!0,"label-bg-style":{fill:"red"},"label-bg-padding":[2,4],"label-bg-border-radius":2},null,8,["id","style","path","marker-end","label","label-x","label-y"]),(0,a.Lk)("g",null,[(0,a.Lk)("circle",{cx:o.sourceX,cy:o.sourceY,r:"4",fill:"#29a3ff"},null,8,Ks),(0,a.Lk)("path",{d:t.value,fill:"none",stroke:"#29a3ff","stroke-width":"2"},null,8,qs),(0,a.Lk)("path",{transform:l.transform,d:`M ${e.targetX} ${e.targetY+2} L ${e.targetX-5} ${e.targetY-10} L ${e.targetX+5} ${e.targetY-10} Z`,fill:"#3e47de",stroke:"none"},null,8,Ws)])],64))}});const Hs=Js;var zs=Hs,Zs=null,Ys={name:"WorkFlow",props:{baseURL:String,workflow_data:{title:"智能助理",info:null,WorkFlowID:"",MainID:"",MainType:2}},components:{VueFlow:d.nO,Background:u.V,MiniMap:r.of,ToolBox:ee,WorkFlowInfo:ie,Controls:c.H,ToolIcon:P,ControlButton:c.a,WorkFlowData:he,LargeModelNode:Co,PluginsNode:Ko,StartNode:Lt,EndNode:Tt,AgentStartNode:ba,AgentEndNode:Ma,SelectorNode:pl,TimeTrigger:nn,AgentNode:Tn,MainAINode:Ls,ReporterNode:Qs,CustomEdge:zs,KnowledgeBaseNode:ql},setup(){const{onInit:e,onNodeDragStop:o,onConnect:t,addEdges:l,setViewport:a,toObject:n,onNodesChange:s,applyNodeChanges:u,onEdgesChange:c,applyEdgeChanges:r}=(0,d.Id)();e((e=>{e.fitView()})),o((()=>{Zs.nodes=n().nodes})),t((e=>{e.id=F.guid(),e.markerEnd=d.TG.ArrowClosed,e.style="stroke-width: 3;stroke:#3e47de;";const o=Zs.nodes.find((o=>o.id===e.source)),t=Zs.nodes.find((o=>o.id===e.target));if(o?.data?.output){t.data.sourceNodes||(t.data.sourceNodes={});const e=o.data.output.map((e=>({...e,id:e.sourceId||`${o.id}_${e.varname}`,displayText:e.displayText||e.varname})));t.data.sourceNodes[o.id]={nodeId:o.id,label:o.data.label,output:e}}l(e),Zs.edges=n().edges})),s((e=>{const o=[];for(const l of e)if("remove"===l.type){var t=Zs.nodes.filter((e=>e.id===l.id));if(t.length>0){if("Start"===t[0].type||"AgentStart"===t[0].type){(0,z.me)({type:"warn",title:"开始节点不能删除"});continue}if("End"===t[0].type||"AgentEnd"===t[0].type){(0,z.me)({type:"warn",title:"结束节点不能删除"});continue}if("MainAI"===t[0].type){(0,z.me)({type:"warn",title:"应用用主控AI不能删除"});continue}if("Reporter"===t[0].type){(0,z.me)({type:"warn",title:"应用记录员不能删除"});continue}o.push(l)}}else o.push(l);u(o)})),c((e=>{const o=[];for(const t of e)if("remove"===t.type){if(Zs.selectedNode)continue;{const e=Zs.edges.find((e=>e.id===t.id));if(e){const o=Zs.nodes.find((o=>o.id===e.target));o?.data?.sourceNodes&&delete o.data.sourceNodes[e.source]}o.push(t)}}else o.push(t);r(o)}));const p=(0,i.KR)(a),h=(0,i.KR)(n);return{_setViewport:p,_toObject:h}},mounted(){let e=this;this.init(),this.startInterval(),Zs=e},unmount(){this.stopInterval()},data(){return{ShowNodeBox:!1,workflow:{title:this.workflow_data.title,info:this.workflow_data.info},info:{},pluginsList:[],largeModelList:[],knowledgeBaseList:[],agentList:[],nodes:[],edges:[],dark:(0,i.KR)(!1),selectedNode:null,selectEdge:null,connectionLineStyle:{stroke:"#ddd",strokeWidth:3},intervalId:null}},methods:{logToObject(){this.save()},resetTransform(){this._setViewport({x:0,y:0,zoom:1})},onShowNodeBox(){this.ShowNodeBox=!this.ShowNodeBox},toggleDarkMode(){this.dark=!this.dark},addNode(e){console.log(e),this.nodes.push(e)},saveNode(e){this.nodes=this.nodes.map((o=>(o.id==e.id&&(o.data=e.data),o)))},nodeClick(e){this.selectedNode=e,this.selectEdge=null},edgeClick(e){this.selectedNode=null,this.selectEdge=e},startInterval(){this.intervalId=setInterval(this.save,5e3)},stopInterval(){this.intervalId&&clearInterval(this.intervalId)},async init(){m.getBaseConfig().then((e=>{if(console.log(e),e.Status){var o=e.Data;this.largeModelList=(0,i.KR)(o.largeModelList),this.pluginsList=o.pluginsList,this.agentList=o.agentList,this.knowledgeBaseList=o.knowledgeBaseList}this.getWorkFlow()})).catch((e=>{console.log(e)}))},getWorkFlow(){var e=this;m.getWorkFlow(e.workflow_data.WorkFlowID,e.workflow_data.MainID,e.workflow_data.MainType).then((e=>{if(e.Status){var o=e.Data;this.info=Object.assign({},this.info,o.Info),o.Nodes.map((e=>{this.nodes.push(e.Config)})),o.Edges.map((e=>{this.edges.push(e.Config)})),this.$forceUpdate()}})).catch((e=>{console.log(e)}))},save(e=null){var o=this,t=o.workflow_data.WorkFlowID,l=o.info;null!=e&&(l.WorkflowName=e.WorkflowName,l.Description=e.Description);var a=this._toObject().nodes.map((e=>({NodeID:e.id,WorkFlowID:t,NodeType:e.type,NodeName:e.data.label,Description:e.data.label,Config:e}))),n=this._toObject().edges.map((e=>({EdgeID:e.id,WorkFlowID:t,SourceNodeId:e.source,TargetNodeId:e.target,Condition:"",LName:"",Config:e}))),s={Info:l,Nodes:a,Edges:n,WorkFlowID:t,MainID:o.workflow_data.MainID,MainType:o.workflow_data.MainType};m.subWorkFlow(s).then((e=>{console.log(e),e.Status&&(o.workflow_data.WorkFlowID=e.Data,o.info.LastUpdateTime=(new Date).toLocaleString())})).catch((e=>{console.log(e)}))}}};const Gs=(0,Y.A)(Ys,[["render",s]]);var ei=Gs;const oi={name:"App",props:{initParams:null},components:{WorkFlow:ei},created(){this.parseUrlParams()},methods:{parseUrlParams(){const e=new URLSearchParams(window.location.search);this.workflow_data.WorkFlowID=e.get("WorkFlowID"),this.workflow_data.MainID=e.get("MainID"),this.workflow_data.MainType=e.get("MainType"),this.baseURL=e.get("baseURL")}},data(){return{baseURL:"",workflow_data:{title:"工作流",info:null,WorkFlowID:"",MainID:"",MainType:2}}}};var ti=Object.assign(oi,{setup(e){return(e,o)=>{const t=(0,a.g2)("notifications");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(ei,{workflow_data:e.workflow_data,baseURL:e.baseURL},null,8,["workflow_data","baseURL"]),(0,a.bF)(t)],64)}}});const li=ti;var ai=li,ni=t(4651),si=(t(4188),{mounted(e){const o=e=>{e.stopPropagation()},t="select"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase()?e:e.querySelector("select, input");t&&(t.addEventListener("mousedown",o),t.addEventListener("wheel",o),t.addEventListener("keydown",o),t.addEventListener("keyup",o),t.addEventListener("input",o),e._stopPropagation={handler:o,target:t})},unmounted(e){if(e._stopPropagation){const{handler:o,target:t}=e._stopPropagation;t.removeEventListener("mousedown",o),t.removeEventListener("wheel",o),t.removeEventListener("keydown",o),t.removeEventListener("keyup",o),t.removeEventListener("input",o),delete e._stopPropagation}}});function ii(e,o,t,n,s,i){return(0,a.uX)(),(0,a.CE)("select",(0,a.v6)({onMousedown:o[0]||(o[0]=(0,l.D$)((()=>{}),["stop"])),onWheel:o[1]||(o[1]=(0,l.D$)((()=>{}),["stop"]))},e.$attrs,{onChange:o[2]||(o[2]=o=>e.$emit("update:modelValue",o.target.value))}),[(0,a.RG)(e.$slots,"default")],16)}var di={name:"StopPropagationSelect",inheritAttrs:!1,emits:["update:modelValue"]};const ui=(0,Y.A)(di,[["render",ii]]);var ci=ui;const ri=window.chatParams||{},pi=(0,l.Ef)(ai,{initParams:ri});pi.use(ni.A),pi.use(z.Ay),pi.directive("stop-propagation",si),pi.component("StopPropagationSelect",ci),pi.mount("#app")}},o={};function t(l){var a=o[l];if(void 0!==a)return a.exports;var n=o[l]={exports:{}};return e[l].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(o,l,a,n){if(!l){var s=1/0;for(c=0;c<e.length;c++){l=e[c][0],a=e[c][1],n=e[c][2];for(var i=!0,d=0;d<l.length;d++)(!1&n||s>=n)&&Object.keys(t.O).every((function(e){return t.O[e](l[d])}))?l.splice(d--,1):(i=!1,n<s&&(s=n));if(i){e.splice(c--,1);var u=a();void 0!==u&&(o=u)}}return o}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[l,a,n]}}(),function(){t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,{a:o}),o}}(),function(){t.d=function(e,o){for(var l in o)t.o(o,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:o[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(o){return 0===e[o]};var o=function(o,l){var a,n,s=l[0],i=l[1],d=l[2],u=0;if(s.some((function(o){return 0!==e[o]}))){for(a in i)t.o(i,a)&&(t.m[a]=i[a]);if(d)var c=d(t)}for(o&&o(l);u<s.length;u++)n=s[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(c)},l=self["webpackChunkworkflow"]=self["webpackChunkworkflow"]||[];l.forEach(o.bind(null,0)),l.push=o.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],(function(){return t(6649)}));l=t.O(l)})();
//# sourceMappingURL=app.d6431b70.js.map